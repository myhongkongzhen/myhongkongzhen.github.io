<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>あなたがいる 、それだけでも</title>
  <subtitle>Z_Z.W</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://myhongkongzhen.github.io/"/>
  <updated>2018-01-02T16:27:27.898Z</updated>
  <id>https://myhongkongzhen.github.io/</id>
  
  <author>
    <name>Z_Z.W</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>英文文法的初級理解</title>
    <link href="https://myhongkongzhen.github.io/archives/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/2018/01/02/201801022306-%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95%E7%9A%84%E5%88%9D%E7%B4%9A%E7%90%86%E8%A7%A3.html"/>
    <id>https://myhongkongzhen.github.io/archives/英文文法/2018/01/02/201801022306-英文文法的初級理解.html</id>
    <published>2018-01-02T15:16:50.000Z</published>
    <updated>2018-01-02T16:27:27.898Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>已經不知道是第幾次看完謝老師的初級文法視頻了，這一次，總算是有了一點小小的心得，總算是理解了文法的概念<br>就像是，一個數學公式，終於明白了他的推導演算過程到最後的結果，而不再是靠死記硬背，不理解他是如何來的，這真是學了二十幾年英語，頭一次，覺得付出有了小小回報了w太開心！</p>
</blockquote>
<a id="more"></a>
<h1 id="初級文法"><a href="#初級文法" class="headerlink" title="初級文法"></a>初級文法</h1><hr>
<h2 id="重點"><a href="#重點" class="headerlink" title="重點"></a>重點</h2><ul>
<li>不定式 : to V<ul>
<li>名詞<ul>
<li><em>主詞</em></li>
<li><em>受詞</em></li>
<li><em>補語</em></li>
</ul>
</li>
<li>形容詞</li>
<li>副詞</li>
</ul>
</li>
<li>動名詞 : Ving<ul>
<li>名詞<ul>
<li><em>主詞</em></li>
<li><em>受詞</em></li>
<li><em>補語</em></li>
</ul>
</li>
</ul>
</li>
<li>分詞 : 形容詞用法<ul>
<li>現在分詞 : Ving<ul>
<li><em>動作進行</em></li>
<li><em>主動</em></li>
</ul>
</li>
<li>過去分詞 : P.P<ul>
<li><em>動作完成</em></li>
<li><em>被動</em></li>
</ul>
</li>
</ul>
</li>
<li>關係代名詞 : <ul>
<li>形容詞子句 : <em>先行詞 + 關係代名詞</em></li>
</ul>
</li>
<li>連接詞 : <ul>
<li>對等連接詞</li>
<li><em>從屬連接詞</em></li>
</ul>
</li>
</ul>
<h1 id="概覽"><a href="#概覽" class="headerlink" title="概覽"></a>概覽</h1><hr>
<p><img src="/images/English/201801022306_初級文法.png"></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;已經不知道是第幾次看完謝老師的初級文法視頻了，這一次，總算是有了一點小小的心得，總算是理解了文法的概念&lt;br&gt;就像是，一個數學公式，終於明白了他的推導演算過程到最後的結果，而不再是靠死記硬背，不理解他是如何來的，這真是學了二十幾年英語，頭一次，覺得付出有了小小回報了w太開心！&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="英文文法" scheme="https://myhongkongzhen.github.io/categories/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/"/>
    
    
      <category term="English" scheme="https://myhongkongzhen.github.io/tags/English/"/>
    
  </entry>
  
  <entry>
    <title>2017年終&#39;思想報告&#39;</title>
    <link href="https://myhongkongzhen.github.io/archives/%E7%B8%BD%E7%B5%90/2017/12/31/201712312302-%E5%B9%B4%E7%B5%82-%E6%80%9D%E6%83%B3%E5%A0%B1%E5%91%8A.html"/>
    <id>https://myhongkongzhen.github.io/archives/總結/2017/12/31/201712312302-年終-思想報告.html</id>
    <published>2017-12-31T15:03:00.000Z</published>
    <updated>2018-01-02T03:56:31.678Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>又是一年，2017再見，2018你好 </p>
</blockquote>
<a id="more"></a>
<h2 id="繼續灰色的2017"><a href="#繼續灰色的2017" class="headerlink" title="繼續灰色的2017"></a>繼續灰色的2017</h2><hr>
<p>記得去年是有寫些什麼的，今個想去翻一翻，結果發現沒有2016的年終‘思想報告’，[笑cry]，應該是覺得沒勁，又刪掉了吧。<br>如同去年一樣，沒什麼可寫的，不過倒是有兩件可以稱之為開心的事情，當然只是自己開心啦。</p>
<ul>
<li>8月底去了UK</li>
<li>對英語語法入了門</li>
</ul>
<h3 id="8月底去UK"><a href="#8月底去UK" class="headerlink" title="8月底去UK"></a>8月底去UK</h3><hr>
<p>算是一件比較開心的事情吧，從小有三個最想去的地方，英國倫敦，法國巴黎，中國香港，不知道為什麼，就是想去這三個地方，估計是佐羅看多了吧，等等，佐羅和UK，巴黎有關係嗎？誰知道呢，倒是小時候經常看佐羅ww，至於HK，那就真是TVB看多了2333，陀槍師姐啊啊啊啊，許多年後，還在盼望著第五部出來，可惜啊，物是人非了。<br>不過長大后，想去的地方又多了一個，霓虹國啊，不知道什麼時候開始，喜歡上日劇的，第一部日劇是什麼呢？龍櫻？還是極道鮮師？亦或是一公升的眼淚？不不不，一定不是這個，不過這劇倒是賺足眼淚，看的時候，真的是哭的稀里嘩啦，以至於現在看到學習日語推薦劇集里有這部劇，都不想再看了，太TM虐了w，哎，那個時候，最愛看的除了TVB，就是霓虹的校園劇了，人家的校服真好看捏2333，再之後，警匪劇，商戰劇，到是古裝劇不咋喜歡，大概是因為無法接受月帶頭吧，可是大多數人評論，月帶頭才是一個美男子的標準，嗯，再次證明了，我的審美跟一般人不一樣，也好，人生在世不過短短數十年，跟所有人都一樣，豈不是白活了www，好像有些強詞奪理了2333，管他呢。<br>去UK旅程中雖然也有不愉快，但總體上，算是圓了小時候的夢吧，也行以後還有機會，故地重遊呢，期待吧。</p>
<h3 id="英語語法"><a href="#英語語法" class="headerlink" title="英語語法"></a>英語語法</h3><hr>
<p>英語虐我千百遍，我待英語如初戀！<br>這才真是虐戀情深呢2333. 這算是後半年的小小開心的事情了吧，好像打通了任督二脈一樣，突然之間，就對語法有了概念，知道課本上的語法講的到底是個什麼玩意了，此之前的狀態一直是：主謂賓補定狀，這都是什麼啊，主謂賓補可以理解，但誰能告訴我定壯是個什麼東西！！！？？？再次[笑cry]就連中文里的這個語法都搞不懂哎，這個怨不得別人，估計得穿越回小學，好好跟語文老師學習才行-_-!!!<br>初初有了語法的概念，還是因為學習了日語，不知為何，學習日語的時候，很快就理解了日語里的時態，變形，大概是因為日語老師交的好吧2333可說來也奇怪，理解了日語的語法之後，現在看日劇，反倒是不怎麼注意語法，很多句子，遛都能遛出口，可到了英語這裡，英語語法就像是數學公式一樣，如果我不會，就真的是天書了2333也許是因為心理上，喜歡日語多一些，所以沒有抵觸心理吧。<br>總而言之，雖然還是不咋地，但至少現在對語法的理解是真的能幫我做閱讀理解了，即使不認識的單詞，也能像別人說的那樣，猜到意思了，還是蠻開心滴2333<br>這裡要鄭重的對英文文法老師謝老師深鞠一躬，沒有反復聽謝老師的文法課程，是打不通任督二脈的ww</p>
<hr>
<h3 id="亂七八糟的其他"><a href="#亂七八糟的其他" class="headerlink" title="亂七八糟的其他"></a>亂七八糟的其他</h3><p>政治方向 —— 這個怎麼說呢，對於2017年發生的民生事件，哎，有時候真不知道該怎麼辦，一天一個反轉，都不知道該信誰，比如*山事件，微博上很熱門，但其實，我總是有那麼一點點小懷疑的，其真實性，大體上，還是不願相信深愛的祖國，有那樣一群牲畜不如的人吧，其他的事件，哎怎麼說呢，總有種心有餘而力不足的感覺，說起來啊，對於國家大事，自己也算是經歷了三個階段，小時候的小粉紅，上學后的憤青，再到現在的…冷漠，大概是因為年紀大了，看多了人和事，人生的不同階段，有了不同的感觸吧。無論怎樣，深愛你——中國。<br>2017已經過去一分鐘了（本想2017最後幾分鐘寫完，麼想到超時了2333），從2014到2017，說實話，感覺自身一直處於低谷，想要翻身，卻不得其所，但人啊，始終要往前看的，難道挫折了，這日子就沒法過了嗎？不還是得一步一個腳印的往前走嘛~~昨個看了一個小視頻，哈利波特作者的演講，主題是“每一次失敗都應該感謝”，嗯，這話用在自己身上吧，其實2017的下半年，還是不錯的，有些小進步的2333</p>
<h2 id="嶄新的2018"><a href="#嶄新的2018" class="headerlink" title="嶄新的2018"></a>嶄新的2018</h2><hr>
<p>2018沒啥好說的，要問新一年的計劃，大概是希望明年能實現去霓虹游一圈的願望吧，當然了英語，日語還是要繼續學習滴，怎麼說，除了搬磚，學習英語日語可是堅持時間最長的事情了23333<br>哦還忘記說了2017還辦了張健身卡，雖然沒怎麼健身，倒是學會了游泳，下了三次水，就不用浮板了2333，雖然只能在100m的池子里游，但總好過不會嘛，之前辦卡的主要目的也是想要學會游泳，不然每次被說‘你海邊長大的，竟然不會游泳？！’太憋屈了www<br>其他的，沒什麼好寫的了，我這人估計最大的優點便是能及時行樂了吧<del>~人生苦短啊</del>~233333333333333</p>
<h1 id="2017再見，-2018你好！"><a href="#2017再見，-2018你好！" class="headerlink" title="2017再見， 2018你好！"></a>2017再見， 2018你好！</h1>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;又是一年，2017再見，2018你好 &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="總結" scheme="https://myhongkongzhen.github.io/categories/%E7%B8%BD%E7%B5%90/"/>
    
    
      <category term="職場" scheme="https://myhongkongzhen.github.io/tags/%E8%81%B7%E5%A0%B4/"/>
    
  </entry>
  
  <entry>
    <title>ELK_搜索引擎_011</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/08/06/ELK-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E-011.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/08/06/ELK-搜索引擎-011.html</id>
    <published>2017-08-06T04:12:32.000Z</published>
    <updated>2017-08-06T04:54:45.631Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>introduce search engine<ul>
<li>_search</li>
<li>multi-index / type</li>
</ul>
</li>
<li>page<ul>
<li>deep paging</li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="Search"><a href="#Search" class="headerlink" title="Search"></a><strong>Search</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /_search</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  "took": 11,  // request use time (ms)</div><div class="line">  "timed_out": false, // 1min return 2000t, 10s return 20t</div><div class="line">  "_shards": &#123;</div><div class="line">    "total": 11,</div><div class="line">    "successful": 11,</div><div class="line">    "failed": 0</div><div class="line">  &#125;,</div><div class="line">  "hits": &#123;</div><div class="line">    "total": 8, // numbe of return result</div><div class="line">    "max_score": 1, // relativity of search key &amp; return result</div><div class="line">    "hits": [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"_index"</span>: <span class="string">".kibana"</span>,</div><div class="line">        <span class="attr">"_type"</span>: <span class="string">"config"</span>,</div><div class="line">        <span class="attr">"_id"</span>: <span class="string">"5.2.0"</span>,</div><div class="line">        <span class="attr">"_score"</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">"_source"</span>: &#123;</div><div class="line">          <span class="attr">"buildNum"</span>: <span class="number">14695</span></div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="attr">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="attr">"_id"</span>: <span class="string">"5"</span>,</div><div class="line">        <span class="attr">"_score"</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">"_source"</span>: &#123;</div><div class="line">          <span class="attr">"name"</span>: <span class="string">"yunnanbaiyao yagao"</span>,</div><div class="line">          <span class="attr">"desc"</span>: <span class="string">"youxiao yizhi zhongyao"</span>,</div><div class="line">          <span class="attr">"price"</span>: <span class="number">25</span>,</div><div class="line">          <span class="attr">"producer"</span>: <span class="string">"yagao yunnanbaiyao producer"</span>,</div><div class="line">          <span class="attr">"tags"</span>: [</div><div class="line">            <span class="string">"yiyao"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;&#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="multi-index-multi-type"><a href="#multi-index-multi-type" class="headerlink" title="multi-index / multi-type"></a><strong>multi-index / multi-type</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">GET /_search</div><div class="line">GET /index1,index2/_search</div><div class="line">GET /*1,*2/_search</div><div class="line">GET /test_inde/test_type/_search</div><div class="line">GET /index1,index2/type1,type2/_search</div><div class="line">GET /index*/<span class="built_in">type</span>*/_search</div><div class="line">GET /_all/type1,type2/_search</div></pre></td></tr></table></figure>
<h2 id="page"><a href="#page" class="headerlink" title="page"></a><strong>page</strong></h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">"hits": &#123;</div><div class="line">   "total": 9,</div><div class="line">   "max_score": 1,</div><div class="line">   "hits": []</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET /test_index/test_type/_search?from=0&amp;size=3 <span class="comment">#0,1,2 page 1</span></div><div class="line">GET /test_index/test_type/_search?from=3&amp;size=3 <span class="comment">#3,4,5 page 2</span></div><div class="line">GET /test_index/test_type/_search?from=6&amp;size=3 <span class="comment">#6,7,8 page 3</span></div></pre></td></tr></table></figure>
<ul>
<li><em>CONTINUE</em></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;introduce search engine&lt;ul&gt;
&lt;li&gt;_search&lt;/li&gt;
&lt;li&gt;multi-index / type&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;page&lt;ul&gt;
&lt;li&gt;deep paging&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_documnet consistency &amp; quorum_010</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/08/05/ELK-documnet-consistency-quorum-010.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/08/05/ELK-documnet-consistency-quorum-010.html</id>
    <published>2017-08-05T14:22:23.000Z</published>
    <updated>2017-08-05T14:59:49.579Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>document writing consistency </li>
<li>quorum</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="Document-consistency"><a href="#Document-consistency" class="headerlink" title="Document consistency"></a><strong>Document consistency</strong></h2><ul>
<li><strong><em>PUT /index/type/id?consistency=XXX</em></strong><ul>
<li>one : primary shard is active </li>
<li>all : all primary shard and replic shard are active </li>
<li>quorum : default value, most partial shard are active<ul>
<li><code>quorum = int ( ( primary + number_of_replicas )/ 2 ) + 1</code></li>
<li>wait 1min, timeout: 100ms( default ), 30s<ul>
<li><strong><em>PUT /index/type/id?timeout=XXX</em></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li>if number of node is less than number of quorum, we cannot do any writing operating.</li>
<li>special operating: number_of_replica &gt; 1, quorum is available</li>
</ul>
</blockquote>
<ul>
<li><em>CONTINUE</em></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;document writing consistency &lt;/li&gt;
&lt;li&gt;quorum&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_documnet &amp; shard routing principle_009</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/08/02/ELK-documnet-shard-routing-principle-009.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/08/02/ELK-documnet-shard-routing-principle-009.html</id>
    <published>2017-08-02T15:50:27.000Z</published>
    <updated>2017-08-05T14:21:07.760Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Document Routing principle </p>
</blockquote>
<a id="more"></a>
<h1 id="Document-Routing"><a href="#Document-Routing" class="headerlink" title="Document Routing"></a>Document Routing</h1><hr>
<ul>
<li>When client creates document, ES determines which shard of index the document is in. </li>
<li>Routing algorithm <ul>
<li><strong><code>shard = hash ( routing ) % number_of_primary_shards</code></strong><ul>
<li>routing = routing id , ex : document_id ( default num , <em>you can be manually specified</em>. )</li>
<li>hash ( routing) = hash ( document_id ) : hash code</li>
<li>mod ( num of primary shards ) -&gt; result is always from <strong>zero</strong> to [ <strong>number_of_primary_shards - 1</strong> ]</li>
<li>routing algorithm is base on primary shard.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="Document-‘CUD’-flow"><a href="#Document-‘CUD’-flow" class="headerlink" title="Document ‘CUD’ flow"></a>Document ‘CUD’ flow</h1><hr>
<ul>
<li>‘CUD’ operating locate on primary shard.<br><img src="http://www.plantuml.com/plantuml/svg/ZPD1JeD058RNp2bUkYy5r4r39YR6hXkwDMccmqkBmWmP1cCrJRo0EzSUm8q7SE5fZ7eBPw3OWgJfXiNC_x_t_JzmNcYcT9cbXEICtx0bWf0npZq8mubY6LBwG9pcAbT9njHwdg-OYZiQHqYDC9Xw0s05v1vnDiJPMHNcQSBPlAYiGPyr2Ygh2gnrqm7oZm3oUu7y6iW_2DIR9QgpAAyFA3W2g3Vcj8wP1mU1UhD4THRbTu1ucg3GBKTjs5vSirjcqEJIN6U9M5PJxA4TijKCXxHfUWpXWePSfbAD5sc9r7Tdc2BNS3chD8HKuyqGJfomIEvn77YKIwdYH31TDmIVJy_VhnzVRuy_xoy4HGpMPFR1toOxfzfebtUhswTG6DF0ZMIf3JresOYXAkjAj9Lmubuej1onv6LcquqW4J7UcIUaaZFxkNVMMOJkHxgFi5I8Wfww4pC84bqquly8jHBEtDbQy9MImlIp8p7mBMUhW-sxgFOgB78f2hIE-ZmSBIWXvwPAyyF-0W00"></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Document Routing principle &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>Using hexo to create github blog</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/08/01/using-hexo-to-create-github-blog.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/08/01/using-hexo-to-create-github-blog.html</id>
    <published>2017-08-01T11:05:51.000Z</published>
    <updated>2017-08-01T11:55:19.439Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Using hexo to create  github blog</p>
</blockquote>
<a id="more"></a>
<h1 id="Prepare-working"><a href="#Prepare-working" class="headerlink" title="Prepare working"></a>Prepare working</h1><hr>
<ul>
<li>Git</li>
<li>Node.js &amp; npm &amp; hexo</li>
</ul>
<h1 id="Init-hexo-working-space"><a href="#Init-hexo-working-space" class="headerlink" title="Init hexo working space"></a>Init hexo working space</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">hexo init myhongkongzhen.github.io</div><div class="line"><span class="comment">#001_hexo_init</span></div><div class="line"></div><div class="line"><span class="comment">#----------------------------------------------------</span></div><div class="line"><span class="built_in">cd</span> myhongkongzhen.github.io</div><div class="line">git init</div><div class="line">git add .</div><div class="line">git ci -m<span class="string">"init hexo blog"</span></div><div class="line"><span class="comment">#002_git_init</span></div><div class="line"><span class="comment">#----------------------------------------------------</span></div><div class="line"></div><div class="line">git submodule add https://github.com/myhongkongzhen/hexo-theme-next.git themes/next</div><div class="line"><span class="comment">#003_add_hexo_theme_next</span></div><div class="line"></div><div class="line"><span class="built_in">cd</span> themes\next</div><div class="line">git remote -v</div><div class="line"><span class="comment">#004_remote_v_01</span></div><div class="line"></div><div class="line">git remote add upstream https://github.com/iissnan/hexo-theme-next.git</div><div class="line">git remote -v</div><div class="line"><span class="comment">#004_remote_v_02</span></div><div class="line"></div><div class="line">git fetch upstream</div><div class="line">git merge upstream/master</div><div class="line"><span class="comment">#004_remote_v_03.jpg</span></div><div class="line"></div><div class="line"><span class="comment">#----------------------------------------------------</span></div><div class="line">git tag</div><div class="line">git co -b mystyle v5.1.1</div><div class="line"><span class="comment">#005_change_release_version_next</span></div><div class="line"></div><div class="line"><span class="comment">#----------------------------------------------------</span></div><div class="line"><span class="built_in">cd</span> myhongkongzhen.github.io</div><div class="line">git remote add origin https://github.com/myhongkongzhen/hexo_blog_src.git</div><div class="line">git push -u origin master</div><div class="line"><span class="comment">#006_add_remote_github</span></div><div class="line"></div><div class="line">hexo s -g --debug -p8888</div><div class="line"><span class="comment">#start hexo blog local server</span></div><div class="line"><span class="comment">#007_start_hexo</span></div><div class="line"></div><div class="line"><span class="comment">#----------------------------------------------------</span></div><div class="line">npm install hexo-deployer-git --save <span class="comment"># deploy to github</span></div><div class="line">npm install hexo-filter-plantuml --save <span class="comment"># plantuml</span></div><div class="line">npm install hexo-generator-feed --save <span class="comment"># feed</span></div><div class="line">npm install hexo-generator-searchdb --save <span class="comment"># local search</span></div><div class="line">npm i --save hexo-wordcount <span class="comment"># wordcount</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Using hexo to create  github blog&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="hexo" scheme="https://myhongkongzhen.github.io/tags/hexo/"/>
    
      <category term="github" scheme="https://myhongkongzhen.github.io/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>UML class diagram</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/31/UML-class.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/31/UML-class.html</id>
    <published>2017-07-31T10:23:52.000Z</published>
    <updated>2017-08-01T07:07:06.700Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>Unified Modeling Language</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="UML-class-diagram"><a href="#UML-class-diagram" class="headerlink" title="UML class diagram"></a>UML class diagram</h1><hr>
<p><img src="http://www.plantuml.com/plantuml/svg/ZLDHJnf147xdLsny1wEF3J4sQPhqXLz0GYvmDQHm6kvCchGc9wtA0UMi2WhILgobPooWjLMuKlWntkxUFV4NEdjp88zzkCtDxCmtCzytkwfgKaxRp6P26rBobRGc4_XF93EIgYRarvgifDH4EhkHaREoegaa6dsUaxBooigR4254VEIfaivA6H9z6mwdmc7oR7sDF251AbaaxFQKbcjaCYpmmP0PuydGyDEKTKqc2tZBJdfEN-TM5qwtyCCjx75ZmBh51trxvg4xzzxLaJCeURL3xxZfZFEyyPwPfZk-dWpBSGNlqK7_sFogH9iMPgCJmkaNcrzK0CFf5o79wRVfzGUwS-VfFzrMsR5tsU4lUbDzqFC409iMjqhKDfr-1nhqz8QtNS4PlDPdscjpSmIO41nNME-8jlEyT0o10h9KvSQbA3ZN51G4IE_JETt_237kJSkrEgvL46FKyrIl1yqMYu0JNENjHwZEFfJ5rjoMnIziLXkms-fasE2NDXs_S_g6-_s0_ZtdtOvtrX4fqEDzGzJrSrbv3qhpmXtyBn199R6bUG4ZaQaZjYGC4DAt_2EjQ7BkfPIKoGlm--AJBVyKDeWVIKK2wUUsPP4WJK9zLlb6pQzJzUTM04DcAm3DWTeO3JEWr303pYp6EEdXBJDqrZHWK-ZeDps0W3Bm5OnjZd0fvZH4Ub76cO28v8nsKQD8N27_IQvRFmt8zO5c_28Yyhlyo91W5ytOyfJThT0gF19uR_y0"><br>IMG download =&gt; <a href="/images/elasticsearch/021_uml_class_01.png">uml_class_extends_implements</a></p>
<p><img src="http://www.plantuml.com/plantuml/svg/RL91I-D06BttLmnUgWYzU9CIN0zxb6NnA4XC1otMIKcYi8WGgsArBNNLkjf6sOAMBDfwwE9cOwm_PcSoarF_mdx9H1PXvp0axtlVU-_ZcpdJKWrhSwEKAQlQkhgA4NmlQoNLD9SBk8n90HFj2yhdFnhg1bQKxGo2arm92Nt2Uhc4aSJZCwqPkcb-BcvXOt9ULosq0jTKKjxvrvosvOpYwfgLKr32d4LqT2s6Fz4ug4QEBNgxh77EZd-CWwCbajVqacxC6hYWv5UKnJLiO5Gq4T5HDcxEeYA1MOW6A4cpPQLBDfTO4jt2Q2AyVAIUpTq1VNdbvovlxqVV7FfQ6GTrrXX2YTcrg7i3E7liyUOepT7ilIkbiUhXaKsVxsB2_cLqsAHUGyf6dIjsyXMOr3_b7K-E1VmbmXoNkpNc0xSFagBw8Bek-F2A3zeV08MkyE9tE6n9Qq3dPHewgj4N1uZiu8arzyAM5rOlX7qW1iVWdQWBknwhXCw3yE-f1w4RwG11AuxrNwsmUiBEkbBbZrq15KXqwyiGuw0jhZhyLviF-j7tFhWa1lL3c2-MWuO9f9feOURTNdDlmC9C_1DlI2v_9pC7ZmeUsLy0"><br>IMG download =&gt; <a href="/images/elasticsearch/021_uml_class_02.png">uml_class_dependency</a></p>
<p><img src="http://www.plantuml.com/plantuml/svg/TLHTRn9157tlhzZuB8qnrOVQaAg9ZttHHv9cfHlQs2w6fIyQawMbNP3YWaArI4jhhAx5WbWY7mBzCTsPsNtgN_3C352gaMINsNlFlNFlFMTcteYhiVZwskhKSpNyJ8re2jQBuLNLC1RnHCChQdmbgY-gaKXCYuYrCZVtAAQkQS7Woob5KVYZY03bYQQ6bxMOC8jV81nTZncQCgiyn2AiNJcC-FgIfiSDk1xBfV2z4kzX7YKG28f0aS5_N_OITUMobwAfFAiS-ubtRl_mifSM8NeqhYatl2E7VUxwHmTUoiBRxMJytNUib4GWVNDyazGstVwvspQ9cO5R9Y7sbojBAKaQtwdvbRpTeRiTUbQyxEs4TD_SOquD1RZd6xHUS0VxtbcJVcoINkl2JBZjB3dzGCgEj4iOpvJunPA_a0mOQNGx5O3fXxfdENHl0ox0n0wem4jzXySljcYvClOWAtCof6kxxLFlKrNE08K-S7yVuqyMo_VgVo8zcrXTPWyGCyRTHvpSe5CXTjtRxFCznbxIAxA2utQtnnCW1ncsqRss5K-_vP26wTLU-vOTqXKvvj60IgJ-XRLAh7Rg7_BDU6AwOv5SdaVVK5H3MPYvnklqzCYoCCC_9CV2C5RK21lb8XXA12hm4YMIIt4LBAj6G5LeEGq9p8MZgz7OR4nR2iuz3HhnM5IFJCf210qx6j63ba4gItVSGGPLOowW4_P9s8Mv4T9bDFoqsFIh1KY3ZwfQ6AjBOZbRsJDHrQGjfCimA5A6WGQGHxR0Svhaafvr0ZWhL4Y-J_8Eo9UIstH8Qdk81SkxFVAvX0J36dvalSOHW99MO43Qlm2orN2xLT74bOf4DsXYiayqnnLeDOUgiq-W538uy4uEsE0RQvP8wjWTR9EiYQBkOIH_2U370FMY1FQjIyutFRi1FNBPN1D6Qbmi_VbsP4p_Hp1t_X6Cj2pSuH-JLuQaU581nieBRVRshI1KBBlbV43QSfYxDPPrv86zYHMhPkG7G3HfKtEVAw7iq4gEJzDAuu3mLegsVxH3AZZ0fxWEhguB4Gig4OjHOJJM2MarwDUCRnuIgq-BRKJWrEFYGIRPt5rH-4ZKl3bfcNerDQ_fIxY1_m00"><br>IMG download =&gt; <a href="/images/elasticsearch/021_uml_class_03.png">uml_class_association_aggregation</a></p>
<p><img src="http://www.plantuml.com/plantuml/svg/hLNDRXf94BxxALgSajKwskIG7yT2neTL3giyWQLe5YFBYZr4W2-9LXhy4uO01h9079OO4yNE189jZBt61F33UAgxv-HNsEefm6F5KIuh8UYQgVhggwglcfbeJ8l4LfQN9bvemUVQGeZX-LbmIOj6dmN3oo_2qSNOObXdqzE_HxJbaD__Qe8n_33sP6LPqvdlhe_zCZdfPxvxFlP7Q85DCN6o3ZcJNVRCO5YFQOjwT59ZaDw0NEEobvpJfuFXfN1aAXAQzq__wO_68c5zWT7FZS1uU1BIvly7P3qS2p4VeTXdLRvruBohoBZwjizNHNdTxXZ2sXV9CtkGkZ1MoHFTw3al7ZkDWZGJpfe5vclqfy3BNXeoxIjAtXVye23ZPONopp7qJX5qJgTmn250T1U5AkJxaBTufOgvPE9OXTxqLfpa-8SgaeV35b_FGhujy-_6VBxtH1ogWXZPdOnSwyD6o-usN2x2Ia4tQtUQv0LlqzwMKEb81x5LbTcwYXvio_gs67mHnsKmT-t1QyWOcD_5Ox9cYKzTNZhZxU9bhmo70sGdLhjmi0VdQpBRWlv7H4DJP0TYl-diD76Ugg3iWVrjbn-z7JrCOaQdjXtWwGJaydYQzJ4jofu-yAZapfsH_VI1Cb217al9nZDuhpoYYoz3K_T-yykF3QfS3QssZVtXbJKexOkC1Sqjg5Ytv5u9YbcdbePgLHffs2_VlYKJTJXjySyfnzY1H9yNEzX1ktyk2jRjwp8SvK6a2-CDBsPvvjGffSJxteMHmY1dTLtMws0UOh41OZAhEfrC19oA8VVYehhhnF-U7GuNARd3HPSVvCcqiP4ufO0ysf57Np68cpbkbgInuIHIl32O_M4iUGKSe-p4DtarXv9tZ08CyjSu89nIYOj50tdezbWjlne7MUx6Nfa_dm9j2Ks1fE2Tmgzu4eqK6UY4qkV61vGdciWKZ1HF9B7xIbcZOQdk6k_n5IAgvsuihoGn5iKxfzyyn4w6vaYbtVSG9uPOEuq9nOro7sV33BGLTkSDlXfUCftcM62gBaz5AFGnbyTgRrnq2g2p2gXOmxMe9Bt1r06Cf9sZjNVlZckvuNp3sJ5HHAG5BvNnPO5HrzAhV7X9Z0B6L5HzyIE-jKdg8rgYq89F9RNWT8tWLP0yWMzTR1B_rxIxDLnjzCHsolOU63rSQcHChNr4YthVLSdGU3Wq_fgO2Udp-4_q7m00"><br>IMG download =&gt; <a href="/images/elasticsearch/021_uml_class_04.png">uml_class_composition</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Unified Modeling Language&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="UML" scheme="https://myhongkongzhen.github.io/tags/UML/"/>
    
  </entry>
  
  <entry>
    <title>ELK_Stage review_008</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/31/ELK-Stage-review-008.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/31/ELK-Stage-review-008.html</id>
    <published>2017-07-31T09:26:42.000Z</published>
    <updated>2017-08-02T15:39:27.998Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Stage review  </p>
<ul>
<li><em>Distributed Document Store</em></li>
<li><strong>文檔數據存儲系統</strong></li>
<li>操作JSON文檔類型數據<ul>
<li>NOSQL存儲系統</li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="Elasticsearch-core-structure"><a href="#Elasticsearch-core-structure" class="headerlink" title="Elasticsearch core structure"></a>Elasticsearch core structure</h1><hr>
<p><img src="http://www.plantuml.com/plantuml/svg/XP9DJyCm38Rl-HNMBfpMiHsdA9eqn943uZwvZGSL-QYSL51D_UzaXT8F2lWGER7zsFARGuZ8iRP6Y0gBLtmcS5xJQGjItZDQKkeY12JhmwNJzBvUgpkCc6EW8H4kNUBLlfs-gkBI8ZUdy8AiRyTm69dpaM3btLUNT1QcrXJW-kGPh6U23X5W1HZWOJkfdrpwrh6fACtxXBbP7lPNmfYYVL5RSZ6H7ltRlvn5rfXtBide13jwKrkNU4VZQprVI6-j-Fjbk7rwhMXdWkxcE--ZJ9Kf2noKcGnoyrEQHHrsexPJgRCiK_CcUv25DvxtJ5h9F2sXQW2T1bsUpyHfpTtGcTpaIcwwL2N4WPnEF_K3"><br>IMG download =&gt; <a href="/images/elasticsearch/020_stage_review.png">ES core structure</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Stage review  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Distributed Document Store&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文檔數據存儲系統&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;操作JSON文檔類型數據&lt;ul&gt;
&lt;li&gt;NOSQL存儲系統&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_batch search_007</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-batch-search-007.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-batch-search-007.html</id>
    <published>2017-07-30T14:23:16.000Z</published>
    <updated>2017-08-06T04:11:00.456Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>Batch query<ul>
<li>mget</li>
<li>bulk </li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="mget"><a href="#mget" class="headerlink" title="_mget"></a>_mget</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">GET /_mget  <span class="comment"># different index &amp; type</span></div><div class="line">&#123;</div><div class="line">    <span class="string">"docs"</span> : [</div><div class="line">        &#123;</div><div class="line">            <span class="string">"_index"</span> : <span class="string">"test_index"</span>,</div><div class="line">            <span class="string">"_type"</span> : <span class="string">"test_type"</span>,</div><div class="line">            <span class="string">"_id"</span> : <span class="string">"1"</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="string">"_index"</span> : <span class="string">"test_index"</span>,</div><div class="line">            <span class="string">"_type"</span> : <span class="string">"test_type"</span>,</div><div class="line">            <span class="string">"_id"</span> : <span class="string">"2"</span></div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/019_mget_search.png"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">GET /test_index/_mget <span class="comment"># the same index and different type</span></div><div class="line">&#123;</div><div class="line">    <span class="string">"docs"</span> : [</div><div class="line">          &#123;</div><div class="line">             <span class="string">"_type"</span> :  <span class="string">"test_type"</span>,</div><div class="line">             <span class="string">"_id"</span> :    1</div><div class="line">          &#125;,</div><div class="line">          &#123;</div><div class="line">             <span class="string">"_type"</span> :  <span class="string">"test_type"</span>,</div><div class="line">             <span class="string">"_id"</span> :    2</div><div class="line">          &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GET /test_index/test_type/_mget <span class="comment"># the same index &amp; type</span></div><div class="line">&#123;</div><div class="line">   <span class="string">"ids"</span>: [1, 2]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="bulk"><a href="#bulk" class="headerlink" title="_bulk"></a>_bulk</h1><hr>
<h2 id="grammar"><a href="#grammar" class="headerlink" title="grammar"></a>grammar</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">POST /_bulk</div><div class="line">&#123;</div><div class="line">    &#123;<span class="string">"action"</span>: &#123;<span class="string">"metadata"</span>&#125;&#125;</div><div class="line">    &#123;<span class="string">"data"</span>&#125;</div><div class="line">&#125;</div><div class="line">POST /test_index/_bulk</div><div class="line">POST /test_index/test_type/_bulk</div></pre></td></tr></table></figure>
<h2 id="operating-types"><a href="#operating-types" class="headerlink" title="operating types"></a>operating types</h2><ul>
<li>delete : delete document</li>
<li>create : PUT /index/type/id/_create</li>
<li>index : PUT /index/type/id, create document or full replace document</li>
<li>update : partial update</li>
</ul>
<h2 id="show-case"><a href="#show-case" class="headerlink" title="show case"></a>show case</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line">POST /_bulk</div><div class="line">&#123; <span class="string">"delete"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 11 &#125; &#125;</div><div class="line">&#123; <span class="string">"create"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 10 &#125; &#125;</div><div class="line">&#123; <span class="string">"test_field"</span> : <span class="string">"test content 10"</span> &#125;</div><div class="line">&#123; <span class="string">"create"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 10 &#125; &#125;</div><div class="line">&#123; <span class="string">"test_field"</span> : <span class="string">"test content 10"</span> &#125;</div><div class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 9 &#125; &#125;</div><div class="line">&#123; <span class="string">"test_field"</span> : <span class="string">"test content 9"</span> &#125;</div><div class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 9 &#125; &#125;</div><div class="line">&#123; <span class="string">"test_field"</span> : <span class="string">"replace test content 9"</span> &#125;</div><div class="line">&#123; <span class="string">"update"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"test_index"</span>, <span class="string">"_type"</span> : <span class="string">"test_type"</span>, <span class="string">"_id"</span> : 10 &#125; &#125;</div><div class="line">&#123; <span class="string">"doc"</span> : &#123; <span class="string">"test_field"</span> : <span class="string">"update test content 10"</span> &#125;&#125; </div><div class="line"></div><div class="line"><span class="comment">#===============================================================================</span></div><div class="line"></div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 33,</div><div class="line">  <span class="string">"errors"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"items"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"delete"</span>: &#123;</div><div class="line">        <span class="string">"found"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"11"</span>,</div><div class="line">        <span class="string">"_version"</span>: 12,</div><div class="line">        <span class="string">"result"</span>: <span class="string">"not_found"</span>,</div><div class="line">        <span class="string">"_shards"</span>: &#123;</div><div class="line">          <span class="string">"total"</span>: 2,</div><div class="line">          <span class="string">"successful"</span>: 1,</div><div class="line">          <span class="string">"failed"</span>: 0</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"status"</span>: 404</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"create"</span>: &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"10"</span>,</div><div class="line">        <span class="string">"status"</span>: 409,</div><div class="line">        <span class="string">"error"</span>: &#123;</div><div class="line">          <span class="string">"type"</span>: <span class="string">"version_conflict_engine_exception"</span>,</div><div class="line">          <span class="string">"reason"</span>: <span class="string">"[test_type][10]: version conflict, document already exists (current version [2])"</span>,</div><div class="line">          <span class="string">"index_uuid"</span>: <span class="string">"220l9S2uSjWUK-G_iIGnBw"</span>,</div><div class="line">          <span class="string">"shard"</span>: <span class="string">"1"</span>,</div><div class="line">          <span class="string">"index"</span>: <span class="string">"test_index"</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"create"</span>: &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"10"</span>,</div><div class="line">        <span class="string">"status"</span>: 409,</div><div class="line">        <span class="string">"error"</span>: &#123;</div><div class="line">          <span class="string">"type"</span>: <span class="string">"version_conflict_engine_exception"</span>,</div><div class="line">          <span class="string">"reason"</span>: <span class="string">"[test_type][10]: version conflict, document already exists (current version [2])"</span>,</div><div class="line">          <span class="string">"index_uuid"</span>: <span class="string">"220l9S2uSjWUK-G_iIGnBw"</span>,</div><div class="line">          <span class="string">"shard"</span>: <span class="string">"1"</span>,</div><div class="line">          <span class="string">"index"</span>: <span class="string">"test_index"</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"index"</span>: &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"9"</span>,</div><div class="line">        <span class="string">"_version"</span>: 5,</div><div class="line">        <span class="string">"result"</span>: <span class="string">"updated"</span>,</div><div class="line">        <span class="string">"_shards"</span>: &#123;</div><div class="line">          <span class="string">"total"</span>: 2,</div><div class="line">          <span class="string">"successful"</span>: 1,</div><div class="line">          <span class="string">"failed"</span>: 0</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"created"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="string">"status"</span>: 200</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"index"</span>: &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"9"</span>,</div><div class="line">        <span class="string">"_version"</span>: 6,</div><div class="line">        <span class="string">"result"</span>: <span class="string">"updated"</span>,</div><div class="line">        <span class="string">"_shards"</span>: &#123;</div><div class="line">          <span class="string">"total"</span>: 2,</div><div class="line">          <span class="string">"successful"</span>: 1,</div><div class="line">          <span class="string">"failed"</span>: 0</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"created"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="string">"status"</span>: 200</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"update"</span>: &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"10"</span>,</div><div class="line">        <span class="string">"_version"</span>: 2,</div><div class="line">        <span class="string">"result"</span>: <span class="string">"noop"</span>,</div><div class="line">        <span class="string">"_shards"</span>: &#123;</div><div class="line">          <span class="string">"total"</span>: 2,</div><div class="line">          <span class="string">"successful"</span>: 1,</div><div class="line">          <span class="string">"failed"</span>: 0</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"status"</span>: 200</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="bulk-size"><a href="#bulk-size" class="headerlink" title="bulk size"></a>bulk size</h2><ul>
<li><code>1000 ~ 5000</code> </li>
<li><code>5 ~ 15M</code></li>
</ul>
<h2 id="bulk-api-json-spatial-format"><a href="#bulk-api-json-spatial-format" class="headerlink" title="bulk api json spatial format"></a>bulk api json spatial format</h2><ul>
<li><p>one data one line, use ‘\n’</p>
<ul>
<li><p>json spatial format VS json format</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="attr">"action"</span>: &#123;<span class="attr">"meta"</span>&#125;&#125;</div><div class="line">   &#123;<span class="attr">"data"</span>&#125;</div><div class="line">   &#123;<span class="attr">"action"</span>: &#123;<span class="attr">"meta"</span>&#125;&#125;</div><div class="line">   &#123;<span class="attr">"data"</span>&#125;</div><div class="line">// ---------------------------- </div><div class="line">       [&#123;</div><div class="line">         <span class="attr">"action"</span>: &#123; &#125;,</div><div class="line">         <span class="attr">"data"</span>: &#123; &#125;</div><div class="line">       &#125;]</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Do not need to translate to jsonArray object</strong></p>
</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Batch query&lt;ul&gt;
&lt;li&gt;mget&lt;/li&gt;
&lt;li&gt;bulk &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_Concurrent conflict_006</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-Concurrent-conflict-006.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-Concurrent-conflict-006.html</id>
    <published>2017-07-30T06:44:47.000Z</published>
    <updated>2017-07-31T09:03:56.664Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>Pessimistic lock<ul>
<li>Relational Database<ul>
<li>ex : MySQL</li>
</ul>
</li>
</ul>
</li>
<li>Optimistic lock<ul>
<li>ex : Elasticsearch </li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h1><hr>
<ul>
<li>Pessimistic lock <ul>
<li>Any time it lock, only one thread can operate data.</li>
</ul>
</li>
<li>Optimistic lock <ul>
<li>Any time it unlock, every thread can operate data, but it has a version info.</li>
</ul>
</li>
</ul>
<h1 id="version"><a href="#version" class="headerlink" title="_version"></a>_version</h1><hr>
<h2 id="internal-version"><a href="#internal-version" class="headerlink" title="internal _version"></a>internal _version</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">  <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">  <span class="string">"_id"</span>: <span class="string">"4"</span>,</div><div class="line">  <span class="string">"_version"</span>: 1, <span class="comment"># any operating , plus 1 (include DELETE, Not physically deleted)</span></div><div class="line">  <span class="string">"result"</span>: <span class="string">"created"</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 2,</div><div class="line">    <span class="string">"successful"</span>: 1,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"created"</span>: <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PUT /test_index/test_type/7?version=2</div><div class="line">&#123; </div><div class="line">  <span class="string">"test_field"</span>:<span class="string">"test field 7.1"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/017_version_update.png"><br><img src="/images/elasticsearch/017_version_update_02.png"></p>
<h2 id="external-version"><a href="#external-version" class="headerlink" title="external version"></a>external version</h2><blockquote>
<ul>
<li>?version=1<strong>&amp;version_type=external</strong><ul>
<li>es, _version=1, ?version=1 ==&gt; update success</li>
<li>es, _version=1, ?version <strong>&gt;1</strong> &amp;version_type=external ==&gt; update success</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="Partial-update-amp-amp-Optimistic-lock"><a href="#Partial-update-amp-amp-Optimistic-lock" class="headerlink" title="Partial update &amp;&amp; Optimistic lock"></a>Partial update &amp;&amp; Optimistic lock</h2><blockquote>
<ul>
<li>retry strategy  <ul>
<li>retry_on_conflict : retry times</li>
</ul>
</li>
</ul>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">POST /test_index/test_type/id/_update?retry_on_conflict=5&amp;version=6</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Pessimistic lock&lt;ul&gt;
&lt;li&gt;Relational Database&lt;ul&gt;
&lt;li&gt;ex : MySQL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Optimistic lock&lt;ul&gt;
&lt;li&gt;ex : Elasticsearch &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_Document core idea_005</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-Document-core-idea-005.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/30/ELK-Document-core-idea-005.html</id>
    <published>2017-07-30T05:21:14.000Z</published>
    <updated>2017-07-31T07:51:29.220Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p><strong>document core metadata</strong>  </p>
<ul>
<li><code>_index</code> </li>
<li><code>_type</code> </li>
<li><code>_id</code> </li>
<li><code>_source</code></li>
</ul>
</blockquote>
<a id="more"></a>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"_index"</span>: <span class="string">"test_index"</span>,</div><div class="line">  <span class="string">"_type"</span>: <span class="string">"test_type"</span>,</div><div class="line">  <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">  <span class="string">"_version"</span>: 1,</div><div class="line">  <span class="string">"found"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"_source"</span>: &#123;</div><div class="line">    <span class="string">"test_content"</span>: <span class="string">"test test"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="index"><a href="#index" class="headerlink" title="_index"></a>_index</h1><hr>
<ul>
<li>One document is in which index.<ul>
<li>The different data(field) need be in different index.</li>
</ul>
</li>
</ul>
<h1 id="type"><a href="#type" class="headerlink" title="_type"></a>_type</h1><hr>
<ul>
<li>One document belongs to which type in index.</li>
</ul>
<h1 id="id"><a href="#id" class="headerlink" title="_id"></a>_id</h1><hr>
<ul>
<li><p>The unique identity of the document.  </p>
<ul>
<li><p>Manual create document id.  </p>
<ul>
<li>Import other system data to ES.  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PUT /test_index/test_type/2</div><div class="line">&#123;</div><div class="line">  <span class="string">"test_content"</span> : <span class="string">"my test"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Auto create document id.  </p>
<ul>
<li>length : 20</li>
<li>url security : base64</li>
<li>GUID<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POST /test_index/test_type</div><div class="line">&#123;</div><div class="line">  <span class="string">"test_content"</span> : <span class="string">"my test"</span> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/images/elasticsearch/012_auto_create_doc_id.png"></p>
</li>
</ul>
</li>
</ul>
<h1 id="source"><a href="#source" class="headerlink" title="_source"></a>_source</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /test_index/test_type/1</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/013_source_get_return.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /test_index/test_type/1?_source=test_field1,test_field2</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/014_source_get_spec_return.png"></p>
<h1 id="Document-replacement"><a href="#Document-replacement" class="headerlink" title="Document replacement"></a>Document replacement</h1><hr>
<ul>
<li>The same as creating the document<ul>
<li>if _id exists, then it will be full replacement.</li>
<li>if not, create new document.<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PUT /test_index/test_type/4</div><div class="line"> &#123; </div><div class="line">   <span class="string">"test_field6"</span>:<span class="string">"test field 6"</span></div><div class="line"> &#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><img src="/images/elasticsearch/015_doc_full_replacement.png"></p>
<ul>
<li>Forced replacement<ul>
<li><strong><code>PUT /index/type/id?op_type=create</code></strong></li>
<li><strong><code>PUT /index/type/id/_create</code></strong></li>
</ul>
</li>
</ul>
<p><img src="/images/elasticsearch/016_doc_forced_replacement.png"></p>
<ul>
<li>Delete document</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DELETE /test_index/test_type/4</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;document core metadata&lt;/strong&gt;  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;_index&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;_type&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;_id&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;_source&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_Elasticsearch core structure_004</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/29/ELK-Elasticsearch-core-structure-004.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/29/ELK-Elasticsearch-core-structure-004.html</id>
    <published>2017-07-29T14:59:21.000Z</published>
    <updated>2017-07-30T06:01:47.294Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>擴容對應用程序的透明性<ul>
<li>垂直擴容與水平擴容</li>
<li>保持負載均衡</li>
</ul>
</li>
<li>Master node<ul>
<li>節點對等，每個節點都能接收所有請求</li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="Shard-amp-Replica"><a href="#Shard-amp-Replica" class="headerlink" title="Shard &amp; Replica"></a>Shard &amp; Replica</h1><hr>
<ul>
<li>One index includes one shard or more shard.<ul>
<li>When we create index, we set 3(ex) primary shard, then ES cluster can be balance for every shard.</li>
</ul>
</li>
<li>Every shard is a minimum working unit, which is a lucene instance.</li>
<li>Every document is in the one primary shard and its replica shard.</li>
<li>We cannot edit the number of primary shard , but can edit the number of replica shard.</li>
<li>The same primary shard and replica shard cannot be in the same node.</li>
</ul>
<h1 id="Create-index"><a href="#Create-index" class="headerlink" title="Create index"></a>Create index</h1><hr>
<h2 id="Under-the-single-node"><a href="#Under-the-single-node" class="headerlink" title="Under the single node"></a>Under the single node</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">PUT /test_index</div><div class="line">&#123;</div><div class="line">    <span class="string">"settings"</span> : &#123;</div><div class="line">        <span class="string">"number_of_shards"</span> : 3,</div><div class="line">        <span class="string">"number_of_replicas"</span> : 1 // Every primary shard has one replica shard.</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Under-the-two-nodes"><a href="#Under-the-two-nodes" class="headerlink" title="Under the two nodes"></a>Under the two nodes</h2><ul>
<li>Primary shard(node 1) data copy to replica shard(node 2).</li>
</ul>
<h1 id="横向擴容"><a href="#横向擴容" class="headerlink" title="横向擴容"></a>横向擴容</h1><hr>
<p>（1）primary&amp;replica自动负载均衡，6个shard，3 primary，3 replica<br>（2）每个node有更少的shard，IO/CPU/Memory资源给每个shard分配更多，每个shard性能更好<br>（3）扩容的极限，6个shard（3 primary，3 replica），最多扩容到6台机器，每个shard可以占用单台服务器的所有资源，性能最好<br>（4）超出扩容极限，动态修改replica数量，9个shard（3primary，6 replica），扩容到9台机器，比3台机器时，拥有3倍的读吞吐量<br>（5）3台机器下，9个shard（3 primary，6 replica），资源更少，但是容错性更好，最多容纳2台机器宕机，6个shard只能容纳1台机器宕机<br><img src="/images/elasticsearch/011_橫向擴容.png"></p>
<h1 id="容錯"><a href="#容錯" class="headerlink" title="容錯"></a>容錯</h1><hr>
<ul>
<li>自動選舉一個node為新的master，承擔master的責任</li>
<li>新的master將丟失的primary shard的某個replica shard提升為primary shard<ul>
<li>Cluster status is yellow now. (P1,P2,P3 primary shard is active, but P1 miss one replica shard copy.)</li>
</ul>
</li>
<li>Restart downtime node.<ul>
<li>新的master會將丟失的副本copy一份到此節點上，該node會使用之前已有的shard數據，只同步一下宕機之後發生的修改.</li>
<li>Cluster status becomes green now.</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;擴容對應用程序的透明性&lt;ul&gt;
&lt;li&gt;垂直擴容與水平擴容&lt;/li&gt;
&lt;li&gt;保持負載均衡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Master node&lt;ul&gt;
&lt;li&gt;節點對等，每個節點都能接收所有請求&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_Kinds of search type_003</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/29/Kinds-of-search-type.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/29/Kinds-of-search-type.html</id>
    <published>2017-07-29T13:25:15.000Z</published>
    <updated>2017-07-31T08:10:46.746Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>Basic Search<ul>
<li>Query string search</li>
<li>Query DSL</li>
<li>Query filter</li>
<li>Full-test search</li>
<li>Phrase search</li>
<li>Highlight search</li>
</ul>
</li>
<li>Advance Search<ul>
<li>Group by</li>
<li>Avg</li>
<li>Sort</li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="Query-string-search"><a href="#Query-string-search" class="headerlink" title="Query string search"></a>Query string search</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /index/<span class="built_in">type</span>/_search <span class="comment"># all result</span></div></pre></td></tr></table></figure>
<h2 id="Case-one"><a href="#Case-one" class="headerlink" title="Case one"></a>Case one</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search <span class="comment"># all result</span></div><div class="line">------------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 7,   // used time(ms)</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>, // <span class="keyword">if</span> it is check out</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 5,  // 5 shard</div><div class="line">    <span class="string">"successful"</span>: 5, // all request hits all primary shard &amp; replica shard</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"hits"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 3, // result</div><div class="line">    <span class="string">"max_score"</span>: 1, // The meaning of the score is the match of a search <span class="keyword">for</span> a search score, the more relevant, the more match, the score is also high</div><div class="line">    <span class="string">"hits"</span>: [ // the details of result documents</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"2"</span>,</div><div class="line">        <span class="string">"_score"</span>: 1,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiajieshi yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"youxiao fangzhu"</span>,</div><div class="line">          <span class="string">"price"</span>: 25,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"jiajieshi producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">        <span class="string">"_score"</span>: 1,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiaqiangban gaolujie yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"gaoxiao meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 30,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"gaolujie producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span>,</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"3"</span>,</div><div class="line">        <span class="string">"_score"</span>: 1,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"zhonghua yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"caoben zhiwu"</span>,</div><div class="line">          <span class="string">"price"</span>: 40,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"zhonghua producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"qingxin"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Case-two"><a href="#Case-two" class="headerlink" title="Case two"></a>Case two</h2><ul>
<li>paramter comes from http request.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search?q=name:yagao&amp;sort=price:asc</div><div class="line">----------------------------------------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 20,</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 5,</div><div class="line">    <span class="string">"successful"</span>: 5,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"hits"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 3,</div><div class="line">    <span class="string">"max_score"</span>: null,</div><div class="line">    <span class="string">"hits"</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"2"</span>,</div><div class="line">        <span class="string">"_score"</span>: null,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiajieshi yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"youxiao fangzhu"</span>,</div><div class="line">          <span class="string">"price"</span>: 25,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"jiajieshi producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"sort"</span>: [</div><div class="line">          25</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">        <span class="string">"_score"</span>: null,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiaqiangban gaolujie yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"gaoxiao meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 30,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"gaolujie producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span>,</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"sort"</span>: [</div><div class="line">          30</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"3"</span>,</div><div class="line">        <span class="string">"_score"</span>: null,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"zhonghua yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"caoben zhiwu"</span>,</div><div class="line">          <span class="string">"price"</span>: 40,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"zhonghua producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"qingxin"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"sort"</span>: [</div><div class="line">          40</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Query-DSL"><a href="#Query-DSL" class="headerlink" title="Query DSL"></a>Query DSL</h1><hr>
<blockquote>
<p>Query Domain Specified Language<br>Http request body: using JSON data structure</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">   <span class="string">"query"</span> : &#123; <span class="string">"match_all"</span> : &#123;&#125; &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123; <span class="string">"match"</span> : &#123; <span class="string">"name"</span> : <span class="string">"yagao"</span> &#125; &#125;,</div><div class="line">    <span class="string">"sort"</span> : [ &#123; <span class="string">"price"</span>  : <span class="string">"desc"</span> &#125; ]</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123; <span class="string">"match_all"</span> : &#123;&#125; &#125;,</div><div class="line">    <span class="string">"from"</span> : 1, // from 0 to total</div><div class="line">    <span class="string">"size"</span> : 2  // query result total</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">   <span class="string">"query"</span> : &#123; <span class="string">"match_all"</span> : &#123;&#125; &#125;,</div><div class="line">   <span class="string">"_source"</span> : [ <span class="string">"name"</span> , <span class="string">"price"</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Query-filter"><a href="#Query-filter" class="headerlink" title="Query filter"></a>Query filter</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123;</div><div class="line">        <span class="string">"bool"</span> : &#123; // include multiple query conditions</div><div class="line">            <span class="string">"must"</span> : &#123; <span class="string">"match"</span> : &#123; <span class="string">"name"</span> : <span class="string">"yagao"</span> &#125; &#125;,</div><div class="line">            <span class="string">"filter"</span> : &#123; <span class="string">"range"</span> : &#123; <span class="string">"price"</span> : &#123; <span class="string">"gt"</span> : 25 &#125; &#125; &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Full-text-search"><a href="#Full-text-search" class="headerlink" title="Full-text search"></a><em>Full-text search</em></h1><hr>
<blockquote>
<p>Producer this field, which will be demolished to build an inverted index</p>
</blockquote>
<table>
<thead>
<tr>
<th>key</th>
<th>item</th>
</tr>
</thead>
<tbody>
<tr>
<td>special</td>
<td>4</td>
</tr>
<tr>
<td>yagao</td>
<td>4</td>
</tr>
<tr>
<td>producer</td>
<td>1,2,3,4</td>
</tr>
<tr>
<td>gaolujie</td>
<td>1</td>
</tr>
<tr>
<td>zhognhua</td>
<td>3</td>
</tr>
<tr>
<td>jiajieshi</td>
<td>2</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123; <span class="string">"match"</span> : &#123; <span class="string">"producer"</span> : <span class="string">"yagao producer"</span> &#125; &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 10,</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 5,</div><div class="line">    <span class="string">"successful"</span>: 5,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"hits"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 4,</div><div class="line">    <span class="string">"max_score"</span>: 0.70293105, // &lt;1&gt;</div><div class="line">    <span class="string">"hits"</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"4"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.70293105, // &lt;2&gt;</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"special yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"special meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 50,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"special yagao producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.25811607, // &lt;3&gt;</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiaqiangban gaolujie yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"gaoxiao meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 30,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"gaolujie producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span>,</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"3"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.25811607, // &lt;4&gt;</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"zhonghua yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"caoben zhiwu"</span>,</div><div class="line">          <span class="string">"price"</span>: 40,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"zhonghua producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"qingxin"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"2"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.1805489, // &lt;5&gt;</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiajieshi yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"youxiao fangzhu"</span>,</div><div class="line">          <span class="string">"price"</span>: 25,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"jiajieshi producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Partial-update"><a href="#Partial-update" class="headerlink" title="Partial update"></a>Partial update</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">POST /index/<span class="built_in">type</span>/id/_update</div><div class="line">&#123;</div><div class="line">    <span class="string">"doc"</span> : &#123;</div><div class="line">        <span class="string">"update_field"</span> : <span class="string">"update field content"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Partial-update-base-on-groovy-script"><a href="#Partial-update-base-on-groovy-script" class="headerlink" title="Partial update base on groovy script"></a>Partial update base on groovy script</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POST test_index/test_type/11/_update</div><div class="line">&#123;</div><div class="line">  <span class="string">"script"</span>: <span class="string">"ctx._source.num += 1"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>To add file test-add-tags.groovy is in the ES path/config/script/.</li>
</ul>
<p><img src="/images/elasticsearch/018_groovy_02.png"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">POST /test_index/test_type/11/_update</div><div class="line">&#123;</div><div class="line">  <span class="string">"script"</span>: &#123;</div><div class="line">    <span class="string">"lang"</span>: <span class="string">"groovy"</span>, </div><div class="line">    <span class="string">"file"</span>: <span class="string">"test-add-tags"</span>,</div><div class="line">    <span class="string">"params"</span>: &#123;</div><div class="line">      <span class="string">"new_tags"</span>: <span class="string">"tag1"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">-------------------------------------------</div><div class="line"></div><div class="line">1.ctx._source.tags += new_tags</div><div class="line">2.ctx.op = ctx._source.num == count ? <span class="string">'delete'</span> : <span class="string">'none'</span></div></pre></td></tr></table></figure></p>
<p><img src="/images/elasticsearch/018_groovy_01.png"></p>
<ul>
<li>If document is not exist, then execute to upsert initial operating</li>
<li>If document is exist, then execute to groovy script operating.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">POST /test_index/test_type/11/_update</div><div class="line">&#123;</div><div class="line">   <span class="string">"script"</span> : <span class="string">"ctx._source.num+=1"</span>,</div><div class="line">   <span class="string">"upsert"</span>: &#123;</div><div class="line">       <span class="string">"num"</span>: 0,</div><div class="line">       <span class="string">"tags"</span>: []</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Phrase-search-短语搜索"><a href="#Phrase-search-短语搜索" class="headerlink" title="Phrase search (短语搜索)"></a>Phrase search (<em>短语搜索</em>)</h1><hr>
<blockquote>
<p>To input the query key, which will be demolished to build an inverted index</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123; <span class="string">"match_phrase"</span> : &#123; <span class="string">"producer"</span> : <span class="string">"yagao producer"</span> &#125; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Highlight-search"><a href="#Highlight-search" class="headerlink" title="Highlight search"></a>Highlight search</h1><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"query"</span> : &#123; <span class="string">"match"</span> : &#123; <span class="string">"producer"</span> : <span class="string">"producer"</span> &#125; &#125;,</div><div class="line">    <span class="string">"highlight"</span>: &#123; <span class="string">"fields"</span> : &#123; <span class="string">"producer"</span> : &#123;&#125; &#125; &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 41,</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 5,</div><div class="line">    <span class="string">"successful"</span>: 5,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"hits"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 4,</div><div class="line">    <span class="string">"max_score"</span>: 0.25811607,</div><div class="line">    <span class="string">"hits"</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.25811607,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiaqiangban gaolujie yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"gaoxiao meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 30,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"gaolujie producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span>,</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"highlight"</span>: &#123;</div><div class="line">          <span class="string">"producer"</span>: [</div><div class="line">            <span class="string">"gaolujie &lt;em&gt;producer&lt;/em&gt;"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"3"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.25811607,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"zhonghua yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"caoben zhiwu"</span>,</div><div class="line">          <span class="string">"price"</span>: 40,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"zhonghua producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"qingxin"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"highlight"</span>: &#123;</div><div class="line">          <span class="string">"producer"</span>: [</div><div class="line">            <span class="string">"zhonghua &lt;em&gt;producer&lt;/em&gt;"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"2"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.1805489,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"jiajieshi yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"youxiao fangzhu"</span>,</div><div class="line">          <span class="string">"price"</span>: 25,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"jiajieshi producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"fangzhu"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"highlight"</span>: &#123;</div><div class="line">          <span class="string">"producer"</span>: [</div><div class="line">            <span class="string">"jiajieshi &lt;em&gt;producer&lt;/em&gt;"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">        <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">        <span class="string">"_id"</span>: <span class="string">"4"</span>,</div><div class="line">        <span class="string">"_score"</span>: 0.14638957,</div><div class="line">        <span class="string">"_source"</span>: &#123;</div><div class="line">          <span class="string">"name"</span>: <span class="string">"special yagao"</span>,</div><div class="line">          <span class="string">"desc"</span>: <span class="string">"special meibai"</span>,</div><div class="line">          <span class="string">"price"</span>: 50,</div><div class="line">          <span class="string">"producer"</span>: <span class="string">"special yagao producer"</span>,</div><div class="line">          <span class="string">"tags"</span>: [</div><div class="line">            <span class="string">"meibai"</span></div><div class="line">          ]</div><div class="line">        &#125;,</div><div class="line">        <span class="string">"highlight"</span>: &#123;</div><div class="line">          <span class="string">"producer"</span>: [</div><div class="line">            <span class="string">"special yagao &lt;em&gt;producer&lt;/em&gt;"</span></div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Aggs"><a href="#Aggs" class="headerlink" title="Aggs"></a>Aggs</h1><hr>
<h2 id="Case-1"><a href="#Case-1" class="headerlink" title="Case 1."></a>Case 1.</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"size"</span> : 0,</div><div class="line">    <span class="string">"aggs"</span> : &#123;</div><div class="line">        <span class="string">"group_by_tags"</span> : &#123; <span class="string">"terms"</span> : &#123; <span class="string">"field"</span> : <span class="string">"tags"</span> &#125; &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">&#123;</div><div class="line">...</div><div class="line"><span class="string">"buckets"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"fangzhu"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 2</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"meibai"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 2</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"qingxin"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 1</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Case-2"><a href="#Case-2" class="headerlink" title="Case 2."></a>Case 2.</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"size"</span> : 0,</div><div class="line">    <span class="string">"aggs"</span> : &#123;</div><div class="line">        <span class="string">"group_by_tags"</span> : &#123;</div><div class="line">            <span class="string">"terms"</span> : &#123; <span class="string">"field"</span> : <span class="string">"tags"</span> , <span class="string">"order"</span> : &#123; <span class="string">"avg_price"</span> : <span class="string">"desc"</span> &#125; &#125;,</div><div class="line">            <span class="string">"aggs"</span> : &#123; <span class="string">"avg_price"</span> : &#123; <span class="string">"avg"</span> : &#123; <span class="string">"field"</span> : <span class="string">"price"</span> &#125; &#125; &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">&#123;</div><div class="line">...</div><div class="line"><span class="string">"buckets"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"fangzhu"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 2,</div><div class="line">          <span class="string">"avg_price"</span>: &#123;</div><div class="line">            <span class="string">"value"</span>: 27.5</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"meibai"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 2,</div><div class="line">          <span class="string">"avg_price"</span>: &#123;</div><div class="line">            <span class="string">"value"</span>: 40</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"qingxin"</span>,</div><div class="line">          <span class="string">"doc_count"</span>: 1,</div><div class="line">          <span class="string">"avg_price"</span>: &#123;</div><div class="line">            <span class="string">"value"</span>: 40</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Case-3"><a href="#Case-3" class="headerlink" title="Case 3."></a>Case 3.</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/_search</div><div class="line">&#123;</div><div class="line">    <span class="string">"size"</span> : 0,</div><div class="line">    <span class="string">"aggs"</span> : &#123;</div><div class="line">        <span class="string">"group_by_price"</span> : &#123;</div><div class="line">            <span class="string">"range"</span> : &#123;</div><div class="line">                <span class="string">"field"</span> : <span class="string">"price"</span>,</div><div class="line">                <span class="string">"ranges"</span> : [</div><div class="line">                    &#123; <span class="string">"from"</span> : 0, <span class="string">"to"</span> : 20 &#125;,</div><div class="line">                    &#123; <span class="string">"from"</span> : 20, <span class="string">"to"</span> : 40 &#125;,</div><div class="line">                    &#123; <span class="string">"from"</span> : 40, <span class="string">"to"</span> : 60 &#125;</div><div class="line">                ]</div><div class="line">            &#125;,</div><div class="line">            <span class="string">"aggs"</span> : &#123;</div><div class="line">                <span class="string">"group_by_tags"</span> : &#123;</div><div class="line">                    <span class="string">"terms"</span> : &#123; <span class="string">"field"</span> : <span class="string">"tags"</span> &#125;,</div><div class="line">                    <span class="string">"aggs"</span> : &#123;</div><div class="line">                        <span class="string">"avg_price"</span> : &#123; <span class="string">"avg"</span> : &#123; <span class="string">"field"</span> : <span class="string">"price"</span> &#125; &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">--------------------------------------------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"took"</span>: 8,</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 5,</div><div class="line">    <span class="string">"successful"</span>: 5,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"hits"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 4,</div><div class="line">    <span class="string">"max_score"</span>: 0,</div><div class="line">    <span class="string">"hits"</span>: []</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"aggregations"</span>: &#123;</div><div class="line">    <span class="string">"group_by_price"</span>: &#123;</div><div class="line">      <span class="string">"buckets"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"0.0-20.0"</span>,</div><div class="line">          <span class="string">"from"</span>: 0,</div><div class="line">          <span class="string">"to"</span>: 20,</div><div class="line">          <span class="string">"doc_count"</span>: 0,</div><div class="line">          <span class="string">"group_by_tags"</span>: &#123;</div><div class="line">            <span class="string">"doc_count_error_upper_bound"</span>: 0,</div><div class="line">            <span class="string">"sum_other_doc_count"</span>: 0,</div><div class="line">            <span class="string">"buckets"</span>: []</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"20.0-40.0"</span>,</div><div class="line">          <span class="string">"from"</span>: 20,</div><div class="line">          <span class="string">"to"</span>: 40,</div><div class="line">          <span class="string">"doc_count"</span>: 2,</div><div class="line">          <span class="string">"group_by_tags"</span>: &#123;</div><div class="line">            <span class="string">"doc_count_error_upper_bound"</span>: 0,</div><div class="line">            <span class="string">"sum_other_doc_count"</span>: 0,</div><div class="line">            <span class="string">"buckets"</span>: [</div><div class="line">              &#123;</div><div class="line">                <span class="string">"key"</span>: <span class="string">"fangzhu"</span>,</div><div class="line">                <span class="string">"doc_count"</span>: 2,</div><div class="line">                <span class="string">"avg_price"</span>: &#123;</div><div class="line">                  <span class="string">"value"</span>: 27.5</div><div class="line">                &#125;</div><div class="line">              &#125;,</div><div class="line">              &#123;</div><div class="line">                <span class="string">"key"</span>: <span class="string">"meibai"</span>,</div><div class="line">                <span class="string">"doc_count"</span>: 1,</div><div class="line">                <span class="string">"avg_price"</span>: &#123;</div><div class="line">                  <span class="string">"value"</span>: 30</div><div class="line">                &#125;</div><div class="line">              &#125;</div><div class="line">            ]</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="string">"key"</span>: <span class="string">"40.0-60.0"</span>,</div><div class="line">          <span class="string">"from"</span>: 40,</div><div class="line">          <span class="string">"to"</span>: 60,</div><div class="line">          <span class="string">"doc_count"</span>: 2,</div><div class="line">          <span class="string">"group_by_tags"</span>: &#123;</div><div class="line">            <span class="string">"doc_count_error_upper_bound"</span>: 0,</div><div class="line">            <span class="string">"sum_other_doc_count"</span>: 0,</div><div class="line">            <span class="string">"buckets"</span>: [</div><div class="line">              &#123;</div><div class="line">                <span class="string">"key"</span>: <span class="string">"meibai"</span>,</div><div class="line">                <span class="string">"doc_count"</span>: 1,</div><div class="line">                <span class="string">"avg_price"</span>: &#123;</div><div class="line">                  <span class="string">"value"</span>: 50</div><div class="line">                &#125;</div><div class="line">              &#125;,</div><div class="line">              &#123;</div><div class="line">                <span class="string">"key"</span>: <span class="string">"qingxin"</span>,</div><div class="line">                <span class="string">"doc_count"</span>: 1,</div><div class="line">                <span class="string">"avg_price"</span>: &#123;</div><div class="line">                  <span class="string">"value"</span>: 40</div><div class="line">                &#125;</div><div class="line">              &#125;</div><div class="line">            ]</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Basic Search&lt;ul&gt;
&lt;li&gt;Query string search&lt;/li&gt;
&lt;li&gt;Query DSL&lt;/li&gt;
&lt;li&gt;Query filter&lt;/li&gt;
&lt;li&gt;Full-test search&lt;/li&gt;
&lt;li&gt;Phrase search&lt;/li&gt;
&lt;li&gt;Highlight search&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Advance Search&lt;ul&gt;
&lt;li&gt;Group by&lt;/li&gt;
&lt;li&gt;Avg&lt;/li&gt;
&lt;li&gt;Sort&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_install &amp; startup Elasticsearch &amp; &#39;CRUD&#39;_002</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/29/install-startup-Elasticsearch.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/29/install-startup-Elasticsearch.html</id>
    <published>2017-07-29T08:21:16.000Z</published>
    <updated>2017-07-31T07:51:29.072Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>To introduce to install &amp; startup Elasticsearch<br>To introduce Document data structure<br>To introduce easy cluster management<br>To study Elasticsearch ‘CRUD’ operation</p>
</blockquote>
<a id="more"></a>
<h1 id="Install-Elasticsearch"><a href="#Install-Elasticsearch" class="headerlink" title="Install Elasticsearch"></a>Install Elasticsearch</h1><hr>
<h2 id="Download-amp-Install-amp-Startup-elasticsearch-Elasticsearch"><a href="#Download-amp-Install-amp-Startup-elasticsearch-Elasticsearch" class="headerlink" title="Download &amp; Install &amp; Startup elasticsearch : Elasticsearch"></a>Download &amp; Install &amp; Startup elasticsearch : <a href="https://www.elastic.co/downloads/elasticsearch" target="_blank" rel="external">Elasticsearch</a></h2><p><img src="/images/elasticsearch/003_install_startup_ES.png"></p>
<h2 id="To-check-if-the-Elasticsearch-startup-success-127-0-0-1-9200"><a href="#To-check-if-the-Elasticsearch-startup-success-127-0-0-1-9200" class="headerlink" title="To check if the Elasticsearch startup success. 127.0.0.1:9200"></a>To check if the Elasticsearch startup success. <a href="http://127.0.0.1:9200/?pretty" target="_blank" rel="external">127.0.0.1:9200</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span> : <span class="string">"PFS_monitor_node-1"</span>, // Node name</div><div class="line">  <span class="string">"cluster_name"</span> : <span class="string">"PFS_monitor_cluster"</span>, // Cluster name</div><div class="line">  <span class="string">"cluster_uuid"</span> : <span class="string">"tBEEZhRUS0O3SmduwgYZVw"</span>, // Cluster uuid</div><div class="line">  <span class="string">"version"</span> : &#123;</div><div class="line">    <span class="string">"number"</span> : <span class="string">"5.2.0"</span>, // Elasticsearch version</div><div class="line">    <span class="string">"build_hash"</span> : <span class="string">"24e05b9"</span>,</div><div class="line">    <span class="string">"build_date"</span> : <span class="string">"2017-01-24T19:52:35.800Z"</span>,</div><div class="line">    <span class="string">"build_snapshot"</span> : <span class="literal">false</span>,</div><div class="line">    <span class="string">"lucene_version"</span> : <span class="string">"6.4.0"</span> // Lucene versoin</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"tagline"</span> : <span class="string">"You Know, for Search"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Download-amp-Install-Kibana-Kibana"><a href="#Download-amp-Install-Kibana-Kibana" class="headerlink" title="Download &amp; Install Kibana : Kibana"></a>Download &amp; Install Kibana : <a href="https://www.elastic.co/downloads/kibana" target="_blank" rel="external">Kibana</a></h2><p><img src="/images/elasticsearch/004_kibana.png"></p>
<h2 id="To-use-kibana-to-study-Elasticsearch-Kibana-dev-tools"><a href="#To-use-kibana-to-study-Elasticsearch-Kibana-dev-tools" class="headerlink" title="To use kibana to study Elasticsearch. Kibana dev tools"></a>To use kibana to study Elasticsearch. <a href="http://localhost:5601/app/kibana#/dev_tools/console?_g=(" target="_blank" rel="external">Kibana dev tools</a></h2><p><img src="/images/elasticsearch/005_healthcheck.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"cluster_name"</span>: <span class="string">"PFS_monitor_cluster"</span>,</div><div class="line">  <span class="string">"status"</span>: <span class="string">"yellow"</span>,</div><div class="line">  <span class="string">"timed_out"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">"number_of_nodes"</span>: 1,</div><div class="line">  <span class="string">"number_of_data_nodes"</span>: 1,</div><div class="line">  <span class="string">"active_primary_shards"</span>: 1,</div><div class="line">  <span class="string">"active_shards"</span>: 1,</div><div class="line">  <span class="string">"relocating_shards"</span>: 0,</div><div class="line">  <span class="string">"initializing_shards"</span>: 0,</div><div class="line">  <span class="string">"unassigned_shards"</span>: 1,</div><div class="line">  <span class="string">"delayed_unassigned_shards"</span>: 0,</div><div class="line">  <span class="string">"number_of_pending_tasks"</span>: 0,</div><div class="line">  <span class="string">"number_of_in_flight_fetch"</span>: 0,</div><div class="line">  <span class="string">"task_max_waiting_in_queue_millis"</span>: 0,</div><div class="line">  <span class="string">"active_shards_percent_as_number"</span>: 50</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Document-Data-Structure"><a href="#Document-Data-Structure" class="headerlink" title="Document Data Structure"></a>Document Data Structure</h1><hr>
<h2 id="Java-Data-Structure"><a href="#Java-Data-Structure" class="headerlink" title="Java Data Structure"></a>Java Data Structure</h2><p><img src="/images/elasticsearch/006_java_data_structure.png"></p>
<h2 id="Database-structure"><a href="#Database-structure" class="headerlink" title="Database structure"></a>Database structure</h2><table>
<thead>
<tr>
<th>table column</th>
<th>t_employee</th>
</tr>
</thead>
<tbody>
<tr>
<td>ee_id</td>
<td>int</td>
</tr>
<tr>
<td>email</td>
<td>varchar</td>
</tr>
<tr>
<td>first_name</td>
<td>varchar</td>
</tr>
<tr>
<td>last_name</td>
<td>varchar</td>
</tr>
<tr>
<td>info_id</td>
<td>int</td>
</tr>
<tr>
<td>join_date</td>
<td>datetime</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>table column</th>
<th>t_employee_info</th>
</tr>
</thead>
<tbody>
<tr>
<td>info_id</td>
<td>int</td>
</tr>
<tr>
<td>bio</td>
<td>varchar</td>
</tr>
<tr>
<td>age</td>
<td>int</td>
</tr>
<tr>
<td>interests</td>
<td>varchar(100)</td>
</tr>
</tbody>
</table>
<h2 id="Document-data-structure"><a href="#Document-data-structure" class="headerlink" title="Document data structure"></a>Document data structure</h2><p>The document data structure of elasticsearch is JSON <strong>基於文檔的數據結構</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    email : myhongkongzhen@gmail.com,</div><div class="line">    first_name : Jane,</div><div class="line">    last_name : Wu,</div><div class="line">    info : &#123;</div><div class="line">        bio : curious and modest,</div><div class="line">        age : 31,</div><div class="line">        interest : [</div><div class="line">            film,</div><div class="line">            takarazuka,</div><div class="line">            eatting</div><div class="line">        ]</div><div class="line">        join_date : Jul 29th 2017</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Elasticsearch-cluster-management"><a href="#Elasticsearch-cluster-management" class="headerlink" title="Elasticsearch cluster management"></a>Elasticsearch cluster management</h1><hr>
<h2 id="ES-health-check"><a href="#ES-health-check" class="headerlink" title="ES health check"></a>ES health check</h2><p>(<a href="http://127.0.0.1:9200/_cat/health?v" target="_blank" rel="external">GET _cat/health?v</a>) <strong>One of the ES apis : _cat</strong><br><img src="/images/elasticsearch/007_es_healthcheck.png"></p>
<h2 id="ES-health-status"><a href="#ES-health-status" class="headerlink" title="ES health status"></a>ES health status</h2><ul>
<li>green<ul>
<li>Every primary shard &amp; replica shard of index is active.</li>
</ul>
</li>
<li>yellow<ul>
<li>Every primary shard of index is active.</li>
<li>Part of replica shard of index is not available.</li>
</ul>
</li>
<li>red<ul>
<li>Part of primary shard of index is not available.</li>
<li>Data of part of index is lost.</li>
</ul>
</li>
</ul>
<h2 id="Check-index-of-cluster"><a href="#Check-index-of-cluster" class="headerlink" title="Check index of cluster"></a>Check index of cluster</h2><p><a href="http://127.0.0.1:9200/_cat/indices?v" target="_blank" rel="external">GET _cat/indices?v</a><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">health status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size</div><div class="line">yellow open   .kibana SCPH1iHxTwiV6naHOTRiig   1   1          1            0      3.1kb          3.1kb</div></pre></td></tr></table></figure></p>
<h2 id="Create-index"><a href="#Create-index" class="headerlink" title="Create index"></a>Create index</h2><p><a href="http://127.0.0.1:9200/zzwu_index?pretty" target="_blank" rel="external">PUT /zzwu_index?pretty</a><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  "acknowledged": true,</div><div class="line">  "shards_acknowledged": true</div><div class="line">&#125;</div><div class="line"></div><div class="line">health status index      uuid                   pri rep docs.count docs.deleted store.size pri.store.size</div><div class="line">yellow open   .kibana    SCPH1iHxTwiV6naHOTRiig   1   1          1            0      3.1kb          3.1kb</div><div class="line">yellow open   zzwu_index AdEOBWZbTvawswsr8jgA-A   5   1          0            0       650b           650b</div></pre></td></tr></table></figure></p>
<h2 id="Delete-index"><a href="#Delete-index" class="headerlink" title="Delete index"></a>Delete index</h2><p><a href="http://127.0.0.1:9200/_cat/indices?v" target="_blank" rel="external">DELETE /zzwu_index?pretty</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"acknowledged"</span>: <span class="literal">true</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">  <span class="string">"error"</span> : &#123;</div><div class="line">    <span class="string">"root_cause"</span> : [</div><div class="line">      &#123;</div><div class="line">        <span class="string">"type"</span> : <span class="string">"index_not_found_exception"</span>,</div><div class="line">        <span class="string">"reason"</span> : <span class="string">"no such index"</span>,</div><div class="line">        <span class="string">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</div><div class="line">        <span class="string">"resource.id"</span> : <span class="string">"zzwu_index"</span>,</div><div class="line">        <span class="string">"index_uuid"</span> : <span class="string">"_na_"</span>,</div><div class="line">        <span class="string">"index"</span> : <span class="string">"zzwu_index"</span></div><div class="line">      &#125;</div><div class="line">    ],</div><div class="line">    <span class="string">"type"</span> : <span class="string">"index_not_found_exception"</span>,</div><div class="line">    <span class="string">"reason"</span> : <span class="string">"no such index"</span>,</div><div class="line">    <span class="string">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</div><div class="line">    <span class="string">"resource.id"</span> : <span class="string">"zzwu_index"</span>,</div><div class="line">    <span class="string">"index_uuid"</span> : <span class="string">"_na_"</span>,</div><div class="line">    <span class="string">"index"</span> : <span class="string">"zzwu_index"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"status"</span> : 404</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Show-Case"><a href="#Show-Case" class="headerlink" title="Show Case"></a>Show Case</h1><hr>
<h2 id="Create-index-amp-type"><a href="#Create-index-amp-type" class="headerlink" title="Create index &amp; type"></a>Create index &amp; type</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PUT /index/<span class="built_in">type</span>/id</div><div class="line">&#123;</div><div class="line">  <span class="string">"json data"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">PUT /ecommerce/product/1</div><div class="line">&#123;</div><div class="line">    <span class="string">"name"</span> : <span class="string">"gaolujie yagao"</span>,</div><div class="line">    <span class="string">"desc"</span> :  <span class="string">"gaoxiao meibai"</span>,</div><div class="line">    <span class="string">"price"</span> :  30,</div><div class="line">    <span class="string">"producer"</span> :      <span class="string">"gaolujie producer"</span>,</div><div class="line">    <span class="string">"tags"</span>: [ <span class="string">"meibai"</span>, <span class="string">"fangzhu"</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/008_create_index_type.png"></p>
<h2 id="Search-document"><a href="#Search-document" class="headerlink" title="Search document"></a>Search document</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /index/<span class="built_in">type</span>/id</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /ecommerce/product/2</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/009_search_index.png"></p>
<h2 id="Edit-document"><a href="#Edit-document" class="headerlink" title="Edit document"></a>Edit document</h2><ul>
<li>replace</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">PUT /ecommerce/product/1</div><div class="line">&#123;</div><div class="line">    <span class="string">"name"</span> : <span class="string">"jiaqiangban gaolujie yagao"</span>,</div><div class="line">    <span class="string">"desc"</span> :  <span class="string">"gaoxiao meibai"</span>,</div><div class="line">    <span class="string">"price"</span> :  30,</div><div class="line">    <span class="string">"producer"</span> :      <span class="string">"gaolujie producer"</span>,</div><div class="line">    <span class="string">"tags"</span>: [ <span class="string">"meibai"</span>, <span class="string">"fangzhu"</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/010_edit_replace_01.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PUT /ecommerce/product/1</div><div class="line">&#123;</div><div class="line">    <span class="string">"name"</span> : <span class="string">"jiaqiangban gaolujie yagao"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/010_edit_replace_02.png"></p>
<ul>
<li>update</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">POST /ecommerce/product/1/_update</div><div class="line">&#123;</div><div class="line">  <span class="string">"doc"</span>: &#123;</div><div class="line">    <span class="string">"name"</span>: <span class="string">"jiaqiangban gaolujie yagao"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/elasticsearch/010_edit_update_02.png"></p>
<h2 id="Delete-document"><a href="#Delete-document" class="headerlink" title="Delete document"></a>Delete document</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">DELETE /ecommerce/product/1</div><div class="line">----------------------------</div><div class="line">&#123;</div><div class="line">  <span class="string">"found"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"_index"</span>: <span class="string">"ecommerce"</span>,</div><div class="line">  <span class="string">"_type"</span>: <span class="string">"product"</span>,</div><div class="line">  <span class="string">"_id"</span>: <span class="string">"1"</span>,</div><div class="line">  <span class="string">"_version"</span>: 10,</div><div class="line">  <span class="string">"result"</span>: <span class="string">"deleted"</span>,</div><div class="line">  <span class="string">"_shards"</span>: &#123;</div><div class="line">    <span class="string">"total"</span>: 2,</div><div class="line">    <span class="string">"successful"</span>: 1,</div><div class="line">    <span class="string">"failed"</span>: 0</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;To introduce to install &amp;amp; startup Elasticsearch&lt;br&gt;To introduce Document data structure&lt;br&gt;To introduce easy cluster management&lt;br&gt;To study Elasticsearch ‘CRUD’ operation&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ELK_白話Elasticsearch_001</title>
    <link href="https://myhongkongzhen.github.io/archives/technology/2017/07/23/ELK-%E7%99%BD%E8%A9%B1Elasticsearch-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/technology/2017/07/23/ELK-白話Elasticsearch-001.html</id>
    <published>2017-07-23T15:04:57.000Z</published>
    <updated>2017-07-31T08:26:39.560Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Elasticsearch分佈式、高性能、高可用、可伸縮的搜索和分析系統 </p>
</blockquote>
<a id="more"></a>
<h1 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h1><hr>
<h5 id="垂直搜索-站內搜索"><a href="#垂直搜索-站內搜索" class="headerlink" title="垂直搜索 (站內搜索)"></a>垂直搜索 (站內搜索)</h5><blockquote>
<ul>
<li><code>互聯網搜索</code><br>  電商網站、招聘網站、新聞網站、各種APP</li>
<li><code>IT系統的搜索</code><br>  OA軟件、辦公自動化、會議管理、日程管理……</li>
</ul>
</blockquote>
<p><em><strong>搜索就是任何場景下，找尋你想要的信息，輸入一段關鍵字，期望找到這個關鍵字相關的信息</strong></em>  </p>
<h1 id="如果用數據庫進行搜索"><a href="#如果用數據庫進行搜索" class="headerlink" title="如果用數據庫進行搜索"></a>如果用數據庫進行搜索</h1><hr>
<h5 id="電商系統"><a href="#電商系統" class="headerlink" title="電商系統"></a>電商系統</h5><pre><code class="sql"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> product_name <span class="keyword">like</span> <span class="string">'%牙膏%'</span>
</code></pre>
<table>
<thead>
<tr>
<th>prod_id</th>
<th>prod_name</th>
<th>prod_desc</th>
<th>prod_img</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>中華牙膏</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>中牙刷膏</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>雲南白藥牙膏</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>佳潔士牙膏</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li>全表掃描,性能會很差   </li>
<li>不能將關鍵字拆分開來，搜索更多符合期望的結果，搜索不到 <strong><em>中牙刷膏</em></strong>  </li>
<li>查詢關鍵字可能很長很長……  </li>
</ul>
</blockquote>
<h1 id="全文檢索和Lucene"><a href="#全文檢索和Lucene" class="headerlink" title="全文檢索和Lucene"></a>全文檢索和Lucene</h1><hr>
<h4 id="1、檢索-倒排索引"><a href="#1、檢索-倒排索引" class="headerlink" title="1、檢索 (倒排索引)"></a>1、檢索 (倒排索引)</h4><blockquote>
<p>全文檢索<br>結構化搜索<br>數據分析</p>
</blockquote>
<pre><code class="markdown">1 生化 危機 電影  
2 生化 危機 海報  
3 生化 危機 文章  
4 生化 危機 新聞
</code></pre>
<table>
<thead>
<tr>
<th>key</th>
<th>ids</th>
</tr>
</thead>
<tbody>
<tr>
<td>生化</td>
<td>1,2,3,4</td>
</tr>
<tr>
<td>危機</td>
<td>1,2,3,4</td>
</tr>
<tr>
<td>電影</td>
<td>1</td>
</tr>
<tr>
<td>海報</td>
<td>2</td>
</tr>
<tr>
<td>文章</td>
<td>3</td>
</tr>
<tr>
<td>新聞</td>
<td>4</td>
</tr>
</tbody>
</table>
<ul>
<li>什麼是全文檢索<br><img src="/images/elasticsearch/001_什麼是全文檢索.png"></li>
<li>倒排索引Wiki<br><img src="/images/elasticsearch/002_倒排索引.png"></li>
</ul>
<h4 id="2、What’s-Lucene"><a href="#2、What’s-Lucene" class="headerlink" title="2、What’s Lucene ?"></a>2、What’s Lucene ?</h4><ul>
<li>簡單來說，Lucene就是一個jar包，包含了封裝好的各種建立倒排索引，以及進行搜索的代碼，包括各種算法。用java開發的時候，引入該jar包，基於路測呢滴api進行開發。  </li>
<li>利用Lucene給已有的數據建立索引，Lucene會在本地磁盤上，組織索引的數據結構，還可以利用Lucene提供的API來針對磁盤上的索引數據，進行搜索。  </li>
</ul>
<h4 id="3、What’s-Elasticsearch"><a href="#3、What’s-Elasticsearch" class="headerlink" title="3、What’s Elasticsearch ?"></a>3、What’s Elasticsearch ?</h4><p>High performance High availability Distributed</p>
<ul>
<li>Lucene is deployed on single server.</li>
<li>When we save the big data, there is not enough space on single server.</li>
<li>When we deploy lucene on more than one sever, we search the data, how do we communicate with multiple machines?</li>
<li>When one lucene server is downtime, we need how to save the data on this server?   <blockquote>
<p><strong>Elasticsearch package underlying lucene.</strong></p>
</blockquote>
</li>
</ul>
<h1 id="Elasticsearch-core-idea"><a href="#Elasticsearch-core-idea" class="headerlink" title="Elasticsearch core idea"></a>Elasticsearch core idea</h1><hr>
<ul>
<li>Near Realtime (NRT) : delay about 1s</li>
<li>Cluster : include several Nodes</li>
<li>Node : to be join default Cluster</li>
<li>Document : the minimum unit of ES, include several fields</li>
<li>Index : include several Types / Documents</li>
<li>Type : logical classification</li>
<li>Shard : Lucene Index, primary shard (易於橫向擴展)</li>
<li>Replica : Copy of Shard, replica shard<br>  There are 10 default shard in one Index, 5 primary shard and 5 replica shard.<br>  <em><strong>Note:</strong> Replica shard and Primary shard cannot be on the same server.</em></li>
</ul>
<table>
<thead>
<tr>
<th>ES</th>
<th>DB</th>
</tr>
</thead>
<tbody>
<tr>
<td>Field</td>
<td>Column</td>
</tr>
<tr>
<td>Document</td>
<td>Row</td>
</tr>
<tr>
<td>Type</td>
<td>Table</td>
</tr>
<tr>
<td>Index</td>
<td>Database</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Elasticsearch分佈式、高性能、高可用、可伸縮的搜索和分析系統 &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="technology" scheme="https://myhongkongzhen.github.io/categories/technology/"/>
    
    
      <category term="Elasticsearch" scheme="https://myhongkongzhen.github.io/tags/Elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>英文初級文法 Unit04 代名詞 — 001</title>
    <link href="https://myhongkongzhen.github.io/archives/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/2016/11/07/201611072216-English01-Unit04-%E4%BB%A3%E5%90%8D%E8%A9%9E-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/英文文法/2016/11/07/201611072216-English01-Unit04-代名詞-001.html</id>
    <published>2016-11-07T14:20:25.000Z</published>
    <updated>2017-07-09T12:30:44.432Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>代名詞：代替名詞 &lt;&lt;&lt;=== 不喜歡重複<br>格 ： 即為表現</p>
</blockquote>
<a id="more"></a>
<h1 id="人稱代名詞"><a href="#人稱代名詞" class="headerlink" title="人稱代名詞"></a>人稱代名詞</h1><hr>
<ul>
<li>人稱代名詞的’人稱’及’格’<br>人稱 \ 格 | 主格 | 所有格 | 受格 | 主格 | 所有格 | 受格 |<br>第一人稱  | I    | my     | me   | we   | our    | us   |<br>第二人稱  | you  | your   | you  | you  | your   | you  |<br>第三人稱  | he   | his    | him  | they | their  | them |<br>他 / 她   | she  | her    | her  |<br>它        | it   | its    | it   |</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;代名詞：代替名詞 &amp;lt;&amp;lt;&amp;lt;=== 不喜歡重複&lt;br&gt;格 ： 即為表現&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="英文文法" scheme="https://myhongkongzhen.github.io/categories/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/"/>
    
    
      <category term="English" scheme="https://myhongkongzhen.github.io/tags/English/"/>
    
  </entry>
  
  <entry>
    <title>Linux權限 — 001</title>
    <link href="https://myhongkongzhen.github.io/archives/%E6%8A%80%E8%A1%93/2016/10/26/201610262247-Linux-Linux%E6%AC%8A%E9%99%90-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/技術/2016/10/26/201610262247-Linux-Linux權限-001.html</id>
    <published>2016-10-26T14:48:32.000Z</published>
    <updated>2017-07-09T12:30:44.431Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>計算資源<ul>
<li>權限 ==&gt; 定義了資源或服務的訪問能力<ul>
<li>用戶 ==&gt; 定義某個用戶 ==&gt; 標示符</li>
<li>用戶組 ==&gt; 定義一類用戶，方便指定權限 ==&gt; 標示符</li>
<li>用戶、用戶組(權限的容器,邏輯概念)，關聯權限</li>
</ul>
</li>
</ul>
</li>
<li><strong>進程是用戶操作計算機的代理</strong></li>
</ul>
</blockquote>
<a id="more"></a>
<ul>
<li>計算機資源三類用戶使用能力<ul>
<li>文件的屬主(u) ==&gt; 文件的所有者</li>
<li>文件的屬組(g) ==&gt; 元生組</li>
<li>其他用戶(o) ==&gt; 既不是屬主也不屬於屬組</li>
</ul>
</li>
<li>用戶 ==&gt; 獲取資源或服務的憑證</li>
<li>進程 ==&gt; 也擁有屬主和屬組<ul>
<li>誰發起的進程，就以誰的身份操作(代理誰)<ul>
<li>進程的發起者與文件的屬主相同，則可以訪問該文件</li>
</ul>
</li>
<li><em><strong>進程的安全上下文</strong></em></li>
</ul>
</li>
<li>權限<ul>
<li>文件權限<ul>
<li>r : readable ==&gt; 可以使用文件察看命令(比如: cat)察看文件</li>
<li>w : writeable ==&gt; 可以編輯或刪除文件</li>
<li>x : exacutable ==&gt; 可以在命令提示符下提交給内核運行<ul>
<li>默認情況下，不應該讓文件有可執行權限</li>
</ul>
</li>
</ul>
</li>
<li>目錄權限<ul>
<li>r : readable ==&gt; 可以對此目錄可以執行ls命令列出内部的所有文件</li>
<li>w : writeable ==&gt; 可以在此目錄中創建文件</li>
<li>x : exacutable ==&gt; 可以使用cd切換至目錄，也可以使用ls命令查看内部文件<ul>
<li>默認情況下，應該讓目錄擁有可執行權限</li>
</ul>
</li>
</ul>
</li>
<li>權限變化組合<ul>
<li>三位一體 二進制 十進制</li>
<li><strong>-–      000     0</strong></li>
<li><strong>--x      001     1</strong></li>
<li><strong>-w-      010     2</strong></li>
<li><strong>-wx      011     3</strong></li>
<li><strong>\r–      100     4</strong></li>
<li><strong>\r-x      101     5</strong></li>
<li><strong>\rw-      110     6</strong></li>
<li><strong>\rwx      111     7</strong></li>
</ul>
</li>
<li>安全上下文<ul>
<li>進程訪問文件，依賴於進程發起者的權限<ul>
<li>發起者是否擁有該文件的訪問權限</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>/etc/passwd</strong> ==&gt; 定義系統中每個用戶信息<ul>
<li>字段意義<ul>
<li>account:passwd(一般為空或者星號，加密密碼在shadow中存儲):uid:gid:user-comments(一般為空,用戶的注釋信息):user-home:user-shell</li>
</ul>
</li>
<li><strong>/etc/shadow</strong> ==&gt; 影子文件，用戶的密碼文件<ul>
<li>字段意義<ul>
<li>account:encrypted-passwd:date1:date2:date3:date4:date5:date6:reservedField<ul>
<li>encrypted passwd ==&gt; 8bit\$<strong><strong>*</strong></strong><ul>
<li>\$1\$\$<strong><em>**</em></strong>(8bit長度)\$<strong><strong><strong><strong>**</strong></strong></strong></strong><ul>
<li>固定長度：標識，特殊意義(防止密碼相同，加密結果相同，被破解)</li>
<li>1 : md5加密方式</li>
</ul>
</li>
<li>!! or * 賬戶被鎖定，不能登錄</li>
</ul>
</li>
<li>date1 : 從19700101開始到密碼最近一次修改密碼的時間所經歷的時間 <ul>
<li>|(19700101)<strong><strong><strong><em>__</em></strong></strong></strong>|(last change pw)<em>__</em>|(current date)</li>
</ul>
</li>
<li>date2 : 密碼最短使用期限</li>
<li>date3 : 密碼最長使用期限</li>
<li>date4 : 警告時間，密碼離過期還有多長時間，開始提示用戶更改密碼 </li>
<li>date5 : 密碼過期之後與用戶禁用之前之間時間，此間用戶登錄，只能改密碼，其他不能操作</li>
<li>date6 : 明確定義從19700101開始到哪一天為止，賬號禁用，賬號有效期<ul>
<li>99999 永不過期</li>
</ul>
</li>
<li>reserved field : 保留字段，暫無意義</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>/etc/group</strong> ==&gt; 定義系統中每個組信息<ul>
<li>gname:psswd:gid:以此組為附加組的用戶列表,用逗號隔開，沒有為空</li>
<li><strong>/etc/gshadow</strong> ==&gt; 組的密碼文件</li>
</ul>
</li>
<li>加密方法<ul>
<li>對稱加密：加密和解密使用同一個密碼<ul>
<li>速度比公鑰加密快3倍以上</li>
</ul>
</li>
<li>公鑰加密：每個密碼都稱對出現，一個私鑰(secret key),一個公鑰(public key)<ul>
<li>加密字段長度比對稱加密長</li>
</ul>
</li>
<li>單向加密：散列加密；用來提取數據特徵碼,每個數據的特徵碼都是唯一的<ul>
<li>不可逆，單方向執行</li>
<li>也稱爲指紋加密, 可用于數據校驗</li>
<li>兩大特性<ul>
<li><ol>
<li>雪崩效應</li>
</ol>
</li>
<li><ol>
<li>定長輸出<ul>
<li>MD5 : Message Digest, 128bit</li>
<li>SHA1 : Secure Hash Algoritm, 160bit(更安全,更慢)</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>用戶類別<ul>
<li>管理員<ul>
<li>UID = 0</li>
</ul>
</li>
<li>普通用戶<ul>
<li>UID = 1 ~ 65535</li>
<li>系統用戶 ==&gt; 專門用來執行後臺程序的用戶，又不需要管理員權限，並且不需要登陸系統的用戶<ul>
<li>UID = 1 ~ 499</li>
</ul>
</li>
<li>一般用戶<ul>
<li>UID = 500 ~ 60000(大約)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>用戶相關權限默認值設置</p>
<ul>
<li>cd /etc/default | file useradd  <figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span> useradd defaults file</div><div class="line">GROUP=100 # </div><div class="line">HOME=/home</div><div class="line">INACTIVE=-1 # 密碼過期，用戶未禁用之間的期限 </div><div class="line">EXPIRE= # 非活動期限</div><div class="line">SHELL=/bin/bash</div><div class="line">SKEL=/etc/skel</div><div class="line">CREATE_MAIL_SPOOL=yes</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>用戶組類別</p>
<ul>
<li>第一种分類<ul>
<li>管理員組</li>
<li>普通用戶組<ul>
<li>系統用戶組</li>
<li>一般用戶組 </li>
</ul>
</li>
</ul>
</li>
<li>第二种分類 (較常用)<ul>
<li>私有組 ==&gt; 創建用戶時，如果沒有指定用戶組，會同時創建一個同名的僅包含該用戶的私有組</li>
<li>基本組 ==&gt; 用戶的默認組 </li>
<li>附加組、額外組 ==&gt; 默認組以外的其他組</li>
</ul>
</li>
</ul>
</li>
<li>權限管理命令<ul>
<li><em><strong>useradd</strong></em> or <em><strong>adduser</strong></em><ul>
<li>ls -l <code>which useradd</code></li>
<li>ls -l \$(which adduser)</li>
<li>useradd tom<ul>
<li>/etc/passwd</li>
<li>/etc/shadow</li>
<li>/etc/group</li>
</ul>
</li>
</ul>
</li>
<li><em><strong>passwd</strong></em><ul>
<li>/etc/shadow</li>
<li>passwd tom<ul>
<li>密碼位 : !! ==&gt; 加密密碼</li>
</ul>
</li>
</ul>
</li>
<li><em><strong>groupadd</strong></em><ul>
<li>groupadd mygroup</li>
</ul>
</li>
<li><em><strong>userdel</strong></em></li>
<li><em><strong>usermod</strong></em></li>
<li><em><strong>chsh</strong></em></li>
<li><em><strong>chfn</strong></em></li>
<li><em><strong>finger</strong></em></li>
<li><em><strong>id</strong></em></li>
<li><em><strong>change</strong></em></li>
<li><em><strong>groupdel</strong></em></li>
<li><em><strong>groupmod</strong></em></li>
<li><em><strong>gpasswd</strong></em></li>
<li><em><strong>chown</strong></em></li>
<li><em><strong>chgrp</strong></em></li>
<li><em><strong>chmod</strong></em></li>
<li><em><strong>umask</strong></em></li>
</ul>
<hr>
</li>
</ul>
<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;計算資源&lt;ul&gt;
&lt;li&gt;權限 ==&amp;gt; 定義了資源或服務的訪問能力&lt;ul&gt;
&lt;li&gt;用戶 ==&amp;gt; 定義某個用戶 ==&amp;gt; 標示符&lt;/li&gt;
&lt;li&gt;用戶組 ==&amp;gt; 定義一類用戶，方便指定權限 ==&amp;gt; 標示符&lt;/li&gt;
&lt;li&gt;用戶、用戶組(權限的容器,邏輯概念)，關聯權限&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;進程是用戶操作計算機的代理&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="技術" scheme="https://myhongkongzhen.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
    
      <category term="LINUX" scheme="https://myhongkongzhen.github.io/tags/LINUX/"/>
    
  </entry>
  
  <entry>
    <title>Shell知識 — 001</title>
    <link href="https://myhongkongzhen.github.io/archives/%E6%8A%80%E8%A1%93/2016/10/25/201610252005-Linux-Shell%E7%9F%A5%E8%AD%98-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/技術/2016/10/25/201610252005-Linux-Shell知識-001.html</id>
    <published>2016-10-25T12:05:32.000Z</published>
    <updated>2017-07-04T02:08:34.527Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>shell: 外殼, 自身也是一個可執行程序，儅用戶登錄之後，打開的命令輸入的環境就是shell</p>
<ol>
<li>GUI: Gnome, KDE, Xface</li>
<li>CLI: sh, csh, ksh, bash, tcsh, zsh </li>
</ol>
</blockquote>
<a id="more"></a>
<h2 id="Shell知識"><a href="#Shell知識" class="headerlink" title="Shell知識"></a>Shell知識</h2><hr>
<ul>
<li><strong>進程是程序的副本</strong><ul>
<li>進程是程序執行的實例，有生命周期，這個過程由内核管理</li>
<li>在每個進程看來，當前主機上只存在内核和當前進程</li>
</ul>
</li>
<li>用戶工作環境<ul>
<li>bash 是支持用戶自我定義自由環境的</li>
</ul>
</li>
<li>shell與子shell<ul>
<li>父子shell之間的設定沒有一定的關聯關係</li>
</ul>
</li>
</ul>
<h4 id="bash特性"><a href="#bash特性" class="headerlink" title="bash特性"></a>bash特性</h4><ul>
<li><ol>
<li>命令歷史、補全<ul>
<li>!(-)N 執行命令歷史中的(倒數)第N條命令</li>
<li>!! 執行剛剛執行過的命令</li>
<li>!XX 執行history中最近的一個指定字符串開頭的命令</li>
<li>!\$ 直接引用上個命令的最後一個參數值<ul>
<li>\$ cat /etc/passwd ==&gt; 察看passwd文件</li>
<li>\$ vim <strong>!$</strong> ==&gt; 用vim編輯/etc/passwd</li>
</ul>
</li>
<li>ESC , . ==&gt; 按下ESC，再按點. 執行上個命令</li>
<li>ALT + . ==&gt; 同上，但要同時按住ALT和點</li>
<li>TAB ==&gt; 補全命令，PATH環境變量設置中的命令:w<ul>
<li><em>路徑補全: 在打頭路徑下搜索</em></li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><ol>
<li>管道、重定向</li>
</ol>
</li>
<li><ol>
<li>命令別名</li>
</ol>
<ul>
<li><em><strong>alias</strong></em> 別名<ul>
<li>在shell中定義的別名，其有效作用範圍僅在當前shell進程</li>
<li>alias clear=’cls’ ==&gt; 給clear起個別名cls</li>
<li>\clear ==&gt; 定義別名后，想要使用原本的命令，加反斜綫</li>
</ul>
</li>
<li><em><strong>unalias</strong></em> 撤銷命令別名 <ul>
<li>unalias clear</li>
</ul>
</li>
</ul>
</li>
<li><ol>
<li>命令行編輯<ul>
<li>ctrl + a ==&gt; 快速跳到行首</li>
<li>ctrl + e ==&gt; 快速跳到行尾</li>
<li>ctrl + u ==&gt; 快速刪除光標至行首</li>
<li>ctrl + k ==&gt; 快速刪除光標至行尾</li>
<li>ctrl + l ==&gt; 快速清屏-&gt;clear</li>
</ul>
</li>
</ol>
</li>
<li><ol>
<li>命令替換 $(COMMAND) or <code>COMMAND</code>-&gt;(反引號)<ul>
<li>把命令中某個子命令替換為其執行結果的過程</li>
<li>echo “The current directory is <code>pwd</code>“</li>
<li>touch ./file-$(date +%F-%H-%M-%S).txt ==&gt; file-2016-10-25-21-34-25.txt</li>
<li><strong>bash中支持的引號</strong><ul>
<li>`` : 反引號 ==&gt; 命令替換</li>
<li>“” : 冒號 ==&gt; 弱引用：可以實現變量替換</li>
<li>‘’ : 單引號 ==&gt; 強引用：不完全變量替換</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><ol>
<li>命令行展開,文件名通配,通配符不能描述所有情況，証則表達式可以解決這個問題 </li>
</ol>
<ul>
<li>* 匹配任意長度、任意字符</li>
<li>\? 匹配任意單個字符</li>
<li style="list-style: none"><input type="checkbox"> 匹配指定範圍内的任意單個字符<ul>
<li>[0-9] 所有數字</li>
<li>[abc] 從abc中選擇一個</li>
<li>[a-z] 所有小寫字母</li>
<li>[A-Z] 所有大寫字母</li>
<li>[a-zA-Z] 所有英文字母</li>
</ul>
</li>
<li>[^] 匹配指定範圍之外的任意字符<ul>
<li>[^0-9] 非數字字符</li>
<li>[:alpha:]][[:space:]][^[:digit:]]</li>
</ul>
</li>
<li>[[ ]] ==&gt; 兩個中括號指定特殊字符<ul>
<li>\$ man 7 glob ==&gt; 察看特殊字符表示<ul>
<li>[[:space:]] 指定空白字符</li>
<li>[[:punct:]] 指定標點符號</li>
<li>[[:upper:]] 指定所有大寫字母</li>
<li>[[:alpha:]] 指定字母表，大小寫字母</li>
<li>[[:digit:]] 指定數字</li>
<li>[[:alnum:]] 指定數字和大小寫字母</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><ol>
<li>變量</li>
</ol>
</li>
<li><ol>
<li>編程</li>
</ol>
</li>
<li><ol>
<li>…</li>
</ol>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;shell: 外殼, 自身也是一個可執行程序，儅用戶登錄之後，打開的命令輸入的環境就是shell&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;GUI: Gnome, KDE, Xface&lt;/li&gt;
&lt;li&gt;CLI: sh, csh, ksh, bash, tcsh, zsh &lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="技術" scheme="https://myhongkongzhen.github.io/categories/%E6%8A%80%E8%A1%93/"/>
    
    
      <category term="LINUX" scheme="https://myhongkongzhen.github.io/tags/LINUX/"/>
    
  </entry>
  
  <entry>
    <title>英文初級文法 Unit03 be動詞、一般動詞的過去式 — 001</title>
    <link href="https://myhongkongzhen.github.io/archives/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/2016/10/24/201610242224-English01-Unit03-be%E5%8B%95%E8%A9%9E-%E4%B8%80%E8%88%AC%E5%8B%95%E8%A9%9E%E9%81%8E%E5%8E%BB%E6%99%82-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/英文文法/2016/10/24/201610242224-English01-Unit03-be動詞-一般動詞過去時-001.html</id>
    <published>2016-10-24T14:24:32.000Z</published>
    <updated>2017-07-09T12:30:44.934Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>時態：動詞會隨著時間而改變形態<br>過去式: 已經發生過的狀態或者動作 </p>
</blockquote>
<a id="more"></a>
<h2 id="be動詞的過去時-gt-was-were"><a href="#be動詞的過去時-gt-was-were" class="headerlink" title="be動詞的過去時 ==&gt; was / were"></a>be動詞的過去時 ==&gt; was / were</h2><hr>
<h4 id="am-is-gt-was-are-gt-were"><a href="#am-is-gt-was-are-gt-were" class="headerlink" title="am / is ==&gt; was | are ==&gt; were"></a>am / is ==&gt; was | are ==&gt; were</h4><ul>
<li>過去時be動詞表示 ==&gt; 過去時間中發生的<strong>狀態</strong> <ul>
<li>He <strong>is</strong> busy <em>now</em>.(現在式)</li>
<li>He <strong>was</strong> busy <em>then</em>.(過去時)<br><strong>時間副詞改變，動詞也要隨之改變</strong></li>
<li>My parents <strong>are</strong> at home <em>now</em>.</li>
<li>My parents <strong>were</strong> at home <em>yesterday</em>.<ul>
<li>我的父母昨天在家，表示今天不在家.</li>
</ul>
</li>
</ul>
</li>
<li>be動詞過去式的否定句 ==&gt; 主詞 + was / were not + …<ul>
<li>Mr. Brown <strong>was</strong> a vet(獸醫). </li>
<li>Mr. Brown was <strong>not</strong> a vet.<ul>
<li>以前不是，現在是</li>
</ul>
</li>
<li>Joe and Brian <strong>were</strong> in the living room <em>at that time</em>(==&gt;then).</li>
<li>Joe and Brian <strong>were not</strong> in the living room <em>at that time</em>.</li>
</ul>
</li>
<li>be動詞過去式的疑問句 <ul>
<li>疑問句 ==&gt; Was / Were 主詞 + … ?</li>
<li>Wendy was in the seventh grade last year.</li>
<li><strong>Was</strong> Wendy in the seventh grade last year?<ul>
<li>Wendy去年就讀7年級嗎?</li>
</ul>
</li>
<li>答句<ul>
<li>Yes, 主詞(代名詞) + was / were.</li>
<li>No, 主詞(代名詞) + was / were.</li>
</ul>
</li>
<li><strong>Were</strong> you a pian<em>ist</em>?(==&gt;什麽樣的人)<ul>
<li>你曾經是個鋼琴傢嗎?</li>
<li>Yes, I was. / No, I weren’t.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="一般動詞的過去時"><a href="#一般動詞的過去時" class="headerlink" title="一般動詞的過去時"></a>一般動詞的過去時</h2><hr>
<ul>
<li>一般動詞過去時的變化<ul>
<li>規則變化 -ed [t] [d] [Id]<ul>
<li>原形動詞 + ed<ul>
<li>helped [t] <em>無聲髮無聲</em></li>
<li>spelled [d] <em>有聲髮有聲</em></li>
<li>wanted [Id]</li>
<li>needed [Id] </li>
</ul>
</li>
<li>原形動詞字尾有e + d<ul>
<li>love -&gt; loved</li>
<li>dance -&gt; danced</li>
</ul>
</li>
<li>原形動詞為子音 + 短母音 ==&gt; 重復字尾 + ed<ul>
<li>stopped</li>
<li>planned</li>
</ul>
</li>
<li>原形動詞字尾為子音 + y ==&gt; 去y + ied<ul>
<li>study -&gt; studied</li>
<li>cry -&gt; cried<ul>
<li><strong>擴展</strong><ul>
<li>現在式 : 去y + ies ==&gt; 第三人稱單數</li>
<li>形容詞 : 去y + ier ==&gt; 比較級</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>不規則動詞變化<ul>
<li>eat -&gt; ate</li>
<li>read -&gt; read</li>
<li>ride -&gt; rode</li>
</ul>
</li>
<li>實例 <ul>
<li>I <strong>walk</strong> to school every day.</li>
<li>I <strong>walked</strong> to school yesterday.</li>
<li>Mother <strong>goes</strong> to a supermarket every morning. </li>
<li>Mother <strong>went</strong> to a supermarket yesterday morning.</li>
</ul>
</li>
</ul>
</li>
<li>一般動詞過去時的否定句 ==&gt; did(助動詞) not + 原形動詞<ul>
<li>He <strong>called</strong> you last night.</li>
<li>He <strong>did not(==&gt; didn’t)</strong> <em>call</em> you last night.</li>
<li>My sister and I <strong>watched</strong> TV all day yesterday.</li>
<li>My sister and I <strong>didn’t</strong> <em>watch</em> TV <em>all</em> day yesterday.<ul>
<li>昨天我和我姐姐並非看了一整天的電視。(只看了一點點電視)<br><strong>not + all ==&gt; 並非全部</strong></li>
</ul>
</li>
</ul>
</li>
<li>一般動詞過去時的疑問句 ==&gt; Did + 主詞 + 原形動詞 … ?<ul>
<li>His friends <strong>went</strong> to that movie last week.<ul>
<li>他的朋友上星期去看了那部電影。</li>
</ul>
</li>
<li><strong>Did</strong> his friends <em>go</em> to that movie last week?</li>
<li>Grace <strong>wrote</strong> a letter to David.</li>
<li><strong>Did</strong> Grace <em>write</em> a letter to David?<ul>
<li>答句<ul>
<li>Yes, he did.</li>
<li>No, he didn’t.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;時態：動詞會隨著時間而改變形態&lt;br&gt;過去式: 已經發生過的狀態或者動作 &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="英文文法" scheme="https://myhongkongzhen.github.io/categories/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/"/>
    
    
      <category term="English" scheme="https://myhongkongzhen.github.io/tags/English/"/>
    
  </entry>
  
  <entry>
    <title>英文初級文法 Unit02 be動詞、一般動詞的現在式 — 001</title>
    <link href="https://myhongkongzhen.github.io/archives/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/2016/10/17/201610200735-English01-Unit02-be%E5%8B%95%E8%A9%9E-%E4%B8%80%E8%88%AC%E5%8B%95%E8%A9%9E%E7%8F%BE%E5%9C%A8%E5%BC%8F-001.html"/>
    <id>https://myhongkongzhen.github.io/archives/英文文法/2016/10/17/201610200735-English01-Unit02-be動詞-一般動詞現在式-001.html</id>
    <published>2016-10-17T13:30:32.000Z</published>
    <updated>2017-07-09T12:30:44.941Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p><strong>be動詞</strong> ==&gt; 表示狀態、存在<br><strong>一般動詞</strong> ==&gt; 表示動作</p>
<ul>
<li>具體動作、抽象動作<ul>
<li>看得見的動作（走路、吃飯、唱歌）</li>
<li>看不見的動作（了解、知道、愛）<br><strong>現在式</strong> ==&gt; 時態、動作的形態會隨著時間改變<br><em><strong>文法名稱代表用法</strong></em></li>
</ul>
</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="be-動詞的現在式-gt-am-is-are"><a href="#be-動詞的現在式-gt-am-is-are" class="headerlink" title="be 動詞的現在式 ==&gt; am , is , are"></a>be 動詞的現在式 ==&gt; am , is , are</h2><hr>
<ul>
<li>be 動詞的含義<ul>
<li>是(狀態) We(s.) are(v.) happy.</li>
<li>在(存在) She is in America.</li>
</ul>
</li>
<li>S. + be<ul>
<li>第一人稱（I）+ am ==&gt;  I am a boy.</li>
<li>第二人稱（You/They）/複數名詞 + are ==&gt;  You are my sons.</li>
<li>第三人稱（He/She）/單數名詞 + is ==&gt;  He is my student.</li>
</ul>
</li>
<li>be 動詞的否定 ==&gt; am / are / is + not<ul>
<li>肯定: 主詞 + am / are / is</li>
<li>否定: 主詞 + am / are / is + not<ul>
<li>He is a good baseball player.</li>
<li>He is not a good baseball player.</li>
</ul>
</li>
</ul>
</li>
<li>be 動詞的疑問句 =&gt; 將 be 動詞 提前<ul>
<li>肯定句：主詞 + am / are / is … .</li>
<li>疑問句：Am / Are / Is + 主詞 … ? ( 嗎？)<ul>
<li>That is his camera.  =&gt; Is that his camera ?</li>
<li>The girl is a junior high(囯中生/senior高中生) school student.</li>
<li>Is the girl a junior high school student ?</li>
</ul>
</li>
<li>be 動詞開頭的疑問句，可用Yes / No 回答。<ul>
<li>Yes, S.(代名詞) + am / are / is.</li>
<li>No, S.(代名詞) + am / are / is not.<ul>
<li>Is that man your math teacher ?</li>
<li>Yes, he is. / No, he is not.(用代名詞回答)</li>
<li>No, he’s my PE(體育老師) teacher.</li>
<li>Are you eating your lunch ?</li>
<li>Yes, I am. / No, I’m not.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="一般動詞的現在式"><a href="#一般動詞的現在式" class="headerlink" title="一般動詞的現在式"></a>一般動詞的現在式</h2><hr>
<ul>
<li>主詞 + 一般動詞==&gt;現在式、主詞為第三人稱單數，一般動詞加 <strong>s</strong>或 <strong>es</strong><ul>
<li>第一人稱 : I like dogs. / We like dogs.</li>
<li>第二人稱 : You like dogs. / You like dogs.</li>
<li>第三人稱 : He <strong>likes</strong> dogs. / They like dogs.</li>
</ul>
</li>
<li>一般動詞加 <strong>s</strong>或 <strong>es</strong>的方法<ul>
<li>大部分動詞加s,其發音為[s]或[z]<ul>
<li>works [s]</li>
<li>plays [z]</li>
</ul>
</li>
<li>字尾為o, s, sh, ch時加es<ul>
<li>goes [z]</li>
<li>washes [IZ]</li>
<li>watches [IZ]</li>
</ul>
</li>
<li>字尾為子音 + y時，去y + ies<ul>
<li>cry –&gt; cries</li>
<li>study –&gt; studyies</li>
</ul>
</li>
<li>have ==&gt; (有、吃)單數動詞 —&gt; has<ul>
<li>They have a lot of money(不可數n.).</li>
<li>He <strong>has</strong> a lot of money.</li>
</ul>
</li>
</ul>
</li>
<li>一般動詞的否定句 ==&gt; 不可以在一般動詞後面直接加NOT,必須用助動詞do/does<ul>
<li>do ==&gt; 用於主詞為I、you 或者複數</li>
<li>does ==&gt; 用於主詞為第三人稱單數<ul>
<li>肯定句 : 主詞 + 一般動詞…</li>
<li>否定句 : 主詞 + do/does + not + 一般動詞原形…<ol>
<li>The twin brothers go to school by bus.</li>
<li>The twin brothers <strong>do not go</strong> to school by bus.</li>
<li>Sam has dinner at the restaurant.</li>
<li>Sam <strong>does not <em>have</em></strong> dinner at the restaurant.</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>比較 : 否定句<ul>
<li>be 動詞<ul>
<li>He is my boyfriend.</li>
<li>He isn’t my boyfriend.</li>
</ul>
</li>
<li>一般動詞<ul>
<li>He likes dogs.</li>
<li>He doesn’t like dogs.</li>
</ul>
</li>
</ul>
</li>
<li>一般動詞的疑問句 ==&gt; 不能把一般動詞放主詞前，要用助動詞do / does <ul>
<li>疑問句 : Do / Does + 主詞 + 一般動詞原形… ?<ol>
<li>You visit(探訪) your grandmother on Sunday<strong>s</strong>(每逢星期天).</li>
</ol>
<ul>
<li>Do you visit your grandmother on Sundays?</li>
</ul>
<ol>
<li>He comes from England.</li>
</ol>
<ul>
<li>Does he come from England?</li>
</ul>
</li>
</ul>
</li>
<li>助動詞do / does開頭的問句、Yes / No回答之後用do / does 回答<ul>
<li>Does the little boy go to school?<ul>
<li>Yes, he does.</li>
<li>No, he doesn’t.</li>
</ul>
</li>
</ul>
</li>
<li>比較 : 疑問句<ul>
<li>be動詞:<ul>
<li>She is beautiful.</li>
<li>Is she beautiful?</li>
<li>Yes, she is.</li>
</ul>
</li>
<li>一般動詞:<ul>
<li>She loves tennis(網球).</li>
<li>Does she love tennis?</li>
<li>Yes, she does.</li>
</ul>
</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;be動詞&lt;/strong&gt; ==&amp;gt; 表示狀態、存在&lt;br&gt;&lt;strong&gt;一般動詞&lt;/strong&gt; ==&amp;gt; 表示動作&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;具體動作、抽象動作&lt;ul&gt;
&lt;li&gt;看得見的動作（走路、吃飯、唱歌）&lt;/li&gt;
&lt;li&gt;看不見的動作（了解、知道、愛）&lt;br&gt;&lt;strong&gt;現在式&lt;/strong&gt; ==&amp;gt; 時態、動作的形態會隨著時間改變&lt;br&gt;&lt;em&gt;&lt;strong&gt;文法名稱代表用法&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="英文文法" scheme="https://myhongkongzhen.github.io/categories/%E8%8B%B1%E6%96%87%E6%96%87%E6%B3%95/"/>
    
    
      <category term="English" scheme="https://myhongkongzhen.github.io/tags/English/"/>
    
  </entry>
  
</feed>
